"use strict";document.addEventListener("DOMContentLoaded",function(){var n=document.querySelectorAll(".language-switcher button"),o=document.querySelectorAll("[data-en], [data-zh]");n.forEach(function(t){t.addEventListener("click",function(){var e=this.getAttribute("data-lang");n.forEach(function(t){return t.classList.remove("active")}),this.classList.add("active"),o.forEach(function(t){t.hasAttribute("data-".concat(e))&&(t.textContent=t.getAttribute("data-".concat(e)))}),localStorage.setItem("marketplace-language",e)})});var d=document.getElementById("payment-modal"),t=document.querySelector(".close-modal"),e=document.querySelectorAll(".buy-button"),a=document.getElementById("create-order-btn"),c=document.getElementById("check-payment-btn"),r=document.getElementById("payment-info"),l=document.getElementById("customer-email"),i=document.getElementById("copy-address");function u(){l.value="",r.classList.add("hidden"),a.classList.remove("hidden"),c.classList.add("hidden"),a.textContent="创建订单",c.textContent="检查支付状态"}e.forEach(function(t){t.addEventListener("click",function(){var t=this.getAttribute("data-product-id"),e=this.getAttribute("data-product-name"),n=this.getAttribute("data-product-price"),o=Math.round(10*parseFloat(n));document.getElementById("modal-product-name").textContent=e,document.getElementById("modal-product-price").textContent=n,document.getElementById("modal-token-amount").textContent=o,d.setAttribute("data-current-product-id",t),d.style.display="block",u()})}),t.addEventListener("click",function(){d.style.display="none",u()}),window.addEventListener("click",function(t){t.target===d&&(d.style.display="none",u())}),a.addEventListener("click",function(){var t=l.value;t&&function(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}(t)?function(n,o){document.getElementById("modal-product-name").textContent,document.getElementById("modal-product-price").textContent;var d=document.getElementById("modal-token-amount").textContent;a.textContent="创建订单中...",a.disabled=!0,setTimeout(function(){var t="XW"+Math.floor(1e6*Math.random()).toString().padStart(6,"0"),e="0x"+Array(40).fill(0).map(function(){return Math.floor(16*Math.random()).toString(16)}).join("");document.getElementById("order-id").textContent=t,document.getElementById("wallet-address").value=e,document.getElementById("payment-token-amount").textContent=d,function(t){if(window.QRCode){var e=document.getElementById("payment-qr-code");e.innerHTML="",new QRCode(e,{text:t,width:170,height:170,colorDark:"#000000",colorLight:"#ffffff"})}else console.error("QRCode库未加载")}(e),function(){var n=15,o=0,d=document.getElementById("expiry-time"),a=setInterval(function(){if(0===n&&0===o)return clearInterval(a),d.textContent="已过期",d.style.color="red",void console.log("订单已过期");0===o?(n--,o=59):o--;var t=n.toString().padStart(2,"0"),e=o.toString().padStart(2,"0");d.textContent="".concat(t,":").concat(e),n<5&&(d.style.color="#ff6b35")},1e3);window.currentCountdownInterval=a}(),r.classList.remove("hidden"),a.classList.add("hidden"),c.classList.remove("hidden"),a.textContent="创建订单",a.disabled=!1,console.log("订单创建成功:",{orderId:t,email:n,productId:o})},1500)}(t,d.getAttribute("data-current-product-id")):alert("请输入有效的邮箱地址")}),c.addEventListener("click",function(){document.getElementById("order-id").textContent;!function(){var t=document.getElementById("order-id").textContent,e=document.getElementById("wallet-address").value,n=document.getElementById("payment-token-amount").textContent;c.textContent="检查中...",c.disabled=!0,setTimeout(function(){.5<Math.random()?(alert("支付成功！确认邮件已发送到您的邮箱地址。"),d.style.display="none",u(),console.log("支付验证成功:",{orderId:t,walletAddress:e,expectedAmount:n})):(alert("暂未检测到支付。请完成支付或稍后重试。"),console.log("支付验证失败:",{orderId:t,walletAddress:e})),c.textContent="检查支付状态",c.disabled=!1},1500)}()}),i.addEventListener("click",function(){var t=this;document.getElementById("wallet-address").select(),document.execCommand("copy"),this.textContent="已复制!",setTimeout(function(){t.textContent="复制"},2e3)})});
//# sourceMappingURL=marketplace.min.js.map
