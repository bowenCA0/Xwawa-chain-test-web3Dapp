{"version":3,"sources":["lottery.js"],"names":["web3","lotteryContract","isConnected","drawCost","userAccount","prizes","isSpinning","probability","color","className","id","name","lotteryABI","inputs","internalType","type","outputs","stateMutability","lotteryContractAddress","xwawaTokenAddress","closeResultModal","modal","document","getElementById","style","display","initLanguageSwitch","languageSwitch","addEventListener","lang","this","checked","switchLanguage","localStorage","setItem","drawTimesInput","drawButton","drawTimesMinusBtn","savedLang","element","querySelectorAll","checkWalletConnection","hasAttribute","textContent","getAttribute","walletManager","accounts","abi","addr","regeneratorRuntime","async","_context","prev","next","awrap","window","ethereum","request","method","sent","length","Web3","ContractConfig","loadLotteryAbi","lotteryAddress","eth","Contract","console","error","t0","updateDrawCostFromContract","t1","stop","connectWallet","_context2","log","on","handleChainChanged","alert","open","code","contractDrawCost","costElement","_costElement","_context3","methods","call","utils","fromWei","updateTotalCost","handleAccountsChanged","chainId","location","reload","updateDrawTimes","change","input","value","newValue","drawTimes","parseInt","isNaN","totalCostElement","totalCost","startDraw","placeholder","_context4","abrupt","drawFromContract","startMagicAnimation","Math","floor","random","setTimeout","showResultModal","addResultsToList","resetDrawState","disabled","getUserTokenBalance","xwawaContract","balance","_context5","getXwawaContract","balanceOf","updateUI","walletStatus","shortenAddress","connectButton","address","substring","getRandomPrize","i","spinWheel","result","results","resultsList","querySelector","noResults","generateMockResults","forEach","resultItem","createElement","innerHTML","concat","Date","toLocaleTimeString","prepend","resultTitle","resultMessage","resultIcon","prizeId","cumulativeProbability","prize","getResultMessage","wheelContainer","pointer","wheelAura","classList","targetAngle","getResultIcon","_prizes","_i","add","finalRotation","wheel","transform","audioContext","AudioContext","webkitAudioContext","oscillator","createOscillator","gainNode","createGain","connect","frequency","setValueAtTime","currentTime","exponentialRampToValueAtTime","gain","start","e","playSpinSound","navigator","vibrate","createMagicEnergyWave","remove","container","particle","left","top","appendChild","draw","times","send","from","tx","xwawaAddress","xwawaABI","_context7","XWAWA_COIN","constant","magicWand","createFireworks","magicWizard","magicSpell","opacity","magicParticles","magicArm","playMagicSound","freq","index","destination","linearRampToValueAtTime","createMagicBurst","colors","background","angle","PI","distance","endX","cos","endY","sin","setProperty","parentNode","removeChild","createSpinningMagicParticles","_loop","x","y","_loop2","wave","borderColor","width","height","drawTimesPlusBtn","validateDrawTimes","init"],"mappings":"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","file":"lottery.min.js","sourcesContent":["/**\n * Xwawa æŠ½å¥–ç³»ç»Ÿ - æ ¸å¿ƒJavaScriptåŠŸèƒ½å®ç°\n * \n * ä¸»è¦åŠŸèƒ½:\n * 1. Web3é’±åŒ…è¿æ¥ (MetaMaskç­‰)\n * 2. æ™ºèƒ½åˆçº¦äº¤äº’ (æŠ½å¥–åˆçº¦ã€ä»£å¸åˆçº¦)\n * 3. æŠ½å¥–è½¬ç›˜åŠ¨ç”»å’ŒéŸ³æ•ˆ\n * 4. æŠ½å¥–ç»“æœå¤„ç†å’Œæ˜¾ç¤º\n * 5. ç”¨æˆ·ç•Œé¢çŠ¶æ€ç®¡ç†\n * \n * æ™ºèƒ½åˆçº¦é›†æˆ:\n * - æŠ½å¥–åˆçº¦: å¤„ç†æŠ½å¥–é€»è¾‘ã€å¥–æ± ç®¡ç†ã€éšæœºæ•°ç”Ÿæˆ\n * - XWAWAä»£å¸åˆçº¦: å¤„ç†ä»£å¸æ”¯ä»˜å’Œä½™é¢æŸ¥è¯¢\n * - äº‹ä»¶ç›‘å¬: æŠ½å¥–ç»“æœã€ä»£å¸è½¬è´¦ç­‰åŒºå—é“¾äº‹ä»¶\n * \n * åç«¯APIéœ€æ±‚:\n * - POST /api/lottery/draw - è®°å½•æŠ½å¥–å†å²\n * - GET /api/lottery/history - è·å–ç”¨æˆ·æŠ½å¥–è®°å½•\n * - GET /api/lottery/stats - è·å–æŠ½å¥–ç»Ÿè®¡æ•°æ®\n * \n * å®‰å…¨è€ƒè™‘:\n * - å®¢æˆ·ç«¯éšæœºæ•°ä»…ç”¨äºåŠ¨ç”»ï¼Œå®é™…ç»“æœç”±æ™ºèƒ½åˆçº¦ç”Ÿæˆ\n * - äº¤æ˜“ç­¾åéªŒè¯\n * - é˜²æ­¢é‡å¤æäº¤\n */\n\n/**\n * å…¨å±€å˜é‡å®šä¹‰\n * ç”¨äºç®¡ç†Web3è¿æ¥ã€åˆçº¦å®ä¾‹å’ŒæŠ½å¥–çŠ¶æ€\n */\nlet web3;                    // Web3å®ä¾‹\nlet lotteryContract;         // æŠ½å¥–æ™ºèƒ½åˆçº¦å®ä¾‹\nlet userAccount;             // ç”¨æˆ·é’±åŒ…åœ°å€\nlet isConnected = false;     // é’±åŒ…è¿æ¥çŠ¶æ€\nlet drawTimes = 1;           // æŠ½å¥–æ¬¡æ•°\nlet drawCost = 10000;        // æ¯æ¬¡æŠ½å¥–èŠ±è´¹çš„XWAWAä»£å¸æ•°é‡ (ä»åˆçº¦è·å–)\nlet isSpinning = false;      // è½¬ç›˜æ—‹è½¬çŠ¶æ€é”\n\n/**\n * å¥–é¡¹é…ç½®\n * å®šä¹‰æŠ½å¥–å¥–é¡¹çš„åŸºæœ¬ä¿¡æ¯å’Œæ¦‚ç‡åˆ†å¸ƒ\n * æ³¨æ„: å®é™…æ¦‚ç‡ç”±æ™ºèƒ½åˆçº¦æ§åˆ¶ï¼Œæ­¤å¤„ä»…ç”¨äºå‰ç«¯å±•ç¤º\n */\nconst prizes = [\n    { id: 1, name: \"ä¸€ç­‰å¥–\", probability: 0.01, color: \"#FF6B6B\", className: \"first-prize\" },\n    { id: 2, name: \"äºŒç­‰å¥–\", probability: 0.05, color: \"#4ECDC4\", className: \"second-prize\" },\n    { id: 3, name: \"ä¸‰ç­‰å¥–\", probability: 0.10, color: \"#FFD166\", className: \"third-prize\" },\n    { id: 4, name: \"å¥–æ± åˆ†çº¢\", probability: 0.15, color: \"#06D6A0\", className: \"pool-prize\" },\n    { id: 5, name: \"åŒå€æŠ½å¥–\", probability: 0.20, color: \"#118AB2\", className: \"double\" },\n    { id: 6, name: \"è°¢è°¢å‚ä¸\", probability: 0.49, color: \"#073B4C\", className: \"nothing\" }\n];\n\n/**\n * æ™ºèƒ½åˆçº¦ABIé…ç½®\n * \n * é‡è¦è¯´æ˜:\n * 1. æ­¤ABIéœ€è¦ä¸éƒ¨ç½²çš„æ™ºèƒ½åˆçº¦å®Œå…¨åŒ¹é…\n * 2. éƒ¨ç½²åˆçº¦åï¼Œéœ€è¦ä»ç¼–è¯‘è¾“å‡ºä¸­è·å–å®Œæ•´ABI\n * 3. å»ºè®®å°†ABIå­˜å‚¨åœ¨å•ç‹¬çš„JSONæ–‡ä»¶ä¸­ï¼Œé€šè¿‡fetchåŠ¨æ€åŠ è½½\n * \n * ä¸»è¦åˆçº¦æ–¹æ³•:\n * - draw(): æ‰§è¡ŒæŠ½å¥–ï¼Œè¿”å›å¥–é¡¹ID\n * - drawCost(): è·å–æŠ½å¥–è´¹ç”¨\n * - getBalance(): è·å–ç”¨æˆ·ä»£å¸ä½™é¢\n * - getPrizePool(): è·å–å¥–æ± é‡‘é¢\n * - getUserDrawHistory(): è·å–ç”¨æˆ·æŠ½å¥–å†å²\n * \n * äº‹ä»¶ç›‘å¬:\n * - DrawResult: æŠ½å¥–ç»“æœäº‹ä»¶\n * - PrizeAwarded: å¥–å“å‘æ”¾äº‹ä»¶\n * - PoolUpdated: å¥–æ± æ›´æ–°äº‹ä»¶\n */\nconst lotteryABI = [\n    // TODO: ä»å®é™…éƒ¨ç½²çš„åˆçº¦ä¸­è·å–å®Œæ•´ABI\n    // ä»¥ä¸‹æ˜¯ç¤ºä¾‹ç»“æ„ï¼Œå®é™…ä½¿ç”¨æ—¶éœ€è¦æ›¿æ¢\n    {\n        \"inputs\": [\n            { \"internalType\": \"uint256\", \"name\": \"_times\", \"type\": \"uint256\" }\n        ],\n        \"name\": \"draw\",\n        \"outputs\": [\n            { \"internalType\": \"uint8[]\", \"name\": \"winningType\", \"type\": \"uint8[]\" }\n        ],\n        \"stateMutability\": \"nonpayable\",\n        \"type\": \"function\"\n    },\n    {\n        \"inputs\": [],\n        \"name\": \"drawCost\",\n        \"outputs\": [\n            {\n                \"internalType\": \"uint256\",\n                \"name\": \"\",\n                \"type\": \"uint256\"\n            }\n        ],\n        \"stateMutability\": \"view\",\n        \"type\": \"function\"\n    }\n    // æ›´å¤šæ–¹æ³•å’Œäº‹ä»¶å®šä¹‰...\n];\n\n/**\n * æ™ºèƒ½åˆçº¦åœ°å€é…ç½®\n * \n * éƒ¨ç½²è¯´æ˜:\n * 1. åœ¨æµ‹è¯•ç½‘éƒ¨ç½²åˆçº¦åï¼Œæ›´æ–°æ­¤åœ°å€\n * 2. ä¸»ç½‘éƒ¨ç½²å‰ï¼Œç¡®ä¿åˆçº¦ç»è¿‡å……åˆ†æµ‹è¯•å’Œå®¡è®¡\n * 3. å»ºè®®ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†ä¸åŒç½‘ç»œçš„åˆçº¦åœ°å€\n * \n * ç½‘ç»œé…ç½®:\n * - æµ‹è¯•ç½‘: Goerli, Sepoliaç­‰\n * - ä¸»ç½‘: Ethereum Mainnet\n * - ä¾§é“¾: Polygon, BSCç­‰\n */\nconst lotteryContractAddress = \"0x1234567890123456789012345678901234567890\"; // TODO: æ›¿æ¢ä¸ºå®é™…éƒ¨ç½²åœ°å€\n\n/**\n * XWAWAä»£å¸åˆçº¦åœ°å€\n * ç”¨äºä»£å¸ä½™é¢æŸ¥è¯¢å’Œæˆæƒæ“ä½œ\n */\nconst xwawaTokenAddress = \"0x0987654321098765432109876543210987654321\"; // TODO: æ›¿æ¢ä¸ºå®é™…ä»£å¸åœ°å€\n\n/**\n * å…³é—­ç»“æœå¼¹çª—\n */\nfunction closeResultModal() {\n    const modal = document.getElementById('result-modal');\n    if (modal) {\n        modal.style.display = 'none';\n    }\n}\n\n/**\n * é¡µé¢åˆå§‹åŒ–\n * åœ¨DOMåŠ è½½å®Œæˆåæ‰§è¡Œæ‰€æœ‰åˆå§‹åŒ–æ“ä½œ\n */\ndocument.addEventListener('DOMContentLoaded', function() {\n    // åˆå§‹åŒ–ç”¨æˆ·ç•Œé¢çŠ¶æ€ï¼ˆç°åœ¨ç”±WalletManagerå¤„ç†ï¼‰\n    // updateUI();\n    \n    // ç»‘å®šç”¨æˆ·äº¤äº’äº‹ä»¶\n    // æ³¨æ„ï¼šé’±åŒ…è¿æ¥ç°åœ¨ç”±WalletManagerå¤„ç†\n    const drawButton = document.getElementById('draw-button');\n    const drawTimesMinusBtn = document.getElementById('draw-times-minus');\n    const drawTimesPlusBtn = document.getElementById('draw-times-plus');\n    const drawTimesInput = document.getElementById('draw-times-input');\n    \n    if (drawButton) drawButton.addEventListener('click', startDraw);\n    if (drawTimesMinusBtn) drawTimesMinusBtn.addEventListener('click', () => updateDrawTimes(-1));\n    if (drawTimesPlusBtn) drawTimesPlusBtn.addEventListener('click', () => updateDrawTimes(1));\n    if (drawTimesInput) drawTimesInput.addEventListener('change', validateDrawTimes);\n    \n    // ç»‘å®šå¼¹çª—å…³é—­äº‹ä»¶\n    document.querySelectorAll('.close-modal, .close-result-btn').forEach(element => {\n        element.addEventListener('click', closeResultModal);\n    });\n    \n    // åˆå§‹åŒ–å¤šè¯­è¨€åŠŸèƒ½\n    initLanguageSwitch();\n    \n    // æ£€æŸ¥æ˜¯å¦å·²è¿æ¥é’±åŒ… (é¡µé¢åˆ·æ–°åæ¢å¤çŠ¶æ€)\n    checkWalletConnection();\n    \n    // åˆå§‹åŒ–é’±åŒ…ç®¡ç†å™¨\n    if (typeof WalletManager !== 'undefined') {\n        const walletManager = new WalletManager();\n        walletManager.init();\n    }\n});\n\n/**\n * åˆå§‹åŒ–è¯­è¨€åˆ‡æ¢åŠŸèƒ½\n * ç»‘å®šè¯­è¨€åˆ‡æ¢å¼€å…³çš„äº‹ä»¶ç›‘å¬å™¨\n */\nfunction initLanguageSwitch() {\n    const languageSwitch = document.getElementById('language-switch');\n    if (languageSwitch) {\n        languageSwitch.addEventListener('change', function() {\n            const lang = this.checked ? 'en' : 'zh';\n            switchLanguage(lang);\n            // ä¿å­˜ç”¨æˆ·è¯­è¨€åå¥½åˆ°æœ¬åœ°å­˜å‚¨\n            localStorage.setItem('preferred-language', lang);\n        });\n        \n        // æ¢å¤ç”¨æˆ·è¯­è¨€åå¥½\n        const savedLang = localStorage.getItem('preferred-language') || 'zh';\n        languageSwitch.checked = savedLang === 'en';\n        switchLanguage(savedLang);\n    }\n}\n\n/**\n * è¯­è¨€åˆ‡æ¢åŠŸèƒ½\n * æ ¹æ®é€‰æ‹©çš„è¯­è¨€æ›´æ–°é¡µé¢æ–‡æœ¬å†…å®¹\n * @param {string} lang - è¯­è¨€ä»£ç  ('zh' æˆ– 'en')\n */\nfunction switchLanguage(lang) {\n    const elements = document.querySelectorAll('[data-lang-zh], [data-lang-en]');\n    \n    elements.forEach(element => {\n        if (lang === 'zh') {\n            if (element.hasAttribute('data-lang-zh')) {\n                element.textContent = element.getAttribute('data-lang-zh');\n            }\n        } else {\n            if (element.hasAttribute('data-lang-en')) {\n                element.textContent = element.getAttribute('data-lang-en');\n            }\n        }\n    });\n}\n\n/**\n * æ£€æŸ¥é’±åŒ…è¿æ¥çŠ¶æ€\n * é¡µé¢åŠ è½½æ—¶æ£€æŸ¥æ˜¯å¦å·²è¿æ¥é’±åŒ…ï¼Œæ¢å¤è¿æ¥çŠ¶æ€\n */\nasync function checkWalletConnection() {\n    if (window.ethereum) {\n        try {\n            const accounts = await window.ethereum.request({ method: 'eth_accounts' });\n            if (accounts.length > 0) {\n                userAccount = accounts[0];\n                web3 = new Web3(window.ethereum);\n                // åŠ¨æ€åŠ è½½ABIä¸éƒ¨ç½²åœ°å€\n                try {\n                    const abi = await window.ContractConfig.loadLotteryAbi();\n                    const addr = window.ContractConfig.lotteryAddress;\n                    if (!addr) {\n                        console.error('Lotteryåˆçº¦åœ°å€æœªé…ç½®ï¼Œè¯·åœ¨ js/contract-config.js ä¸­å¡«å†™ lotteryAddress');\n                    } else {\n                        lotteryContract = new web3.eth.Contract(abi, addr);\n                    }\n                } catch (e) {\n                    console.error('åŠ è½½Lottery ABIå¤±è´¥:', e);\n                }\n                isConnected = true;\n                // updateUI(); // ç°åœ¨ç”±WalletManagerå¤„ç†\n                \n                // è·å–æœ€æ–°çš„æŠ½å¥–æˆæœ¬\n                await updateDrawCostFromContract();\n            }\n        } catch (error) {\n            console.error(\"æ£€æŸ¥é’±åŒ…è¿æ¥å¤±è´¥:\", error);\n        }\n    }\n}\n\n/**\n * è¿æ¥é’±åŒ…åŠŸèƒ½\n * æ£€æµ‹å¹¶è¿æ¥ç”¨æˆ·çš„Web3é’±åŒ… (ä¸»è¦æ”¯æŒMetaMask)\n * \n * åŠŸèƒ½æµç¨‹:\n * 1. æ£€æµ‹é’±åŒ…æ˜¯å¦å®‰è£…\n * 2. è¯·æ±‚ç”¨æˆ·æˆæƒè¿æ¥\n * 3. åˆå§‹åŒ–Web3å®ä¾‹å’Œæ™ºèƒ½åˆçº¦\n * 4. è·å–åˆçº¦å‚æ•° (æŠ½å¥–æˆæœ¬ç­‰)\n * 5. æ›´æ–°UIçŠ¶æ€\n * \n * é”™è¯¯å¤„ç†:\n * - é’±åŒ…æœªå®‰è£…: æç¤ºç”¨æˆ·å®‰è£…MetaMask\n * - ç”¨æˆ·æ‹’ç»è¿æ¥: æ˜¾ç¤ºè¿æ¥å¤±è´¥ä¿¡æ¯\n * - ç½‘ç»œé”™è¯¯: æç¤ºæ£€æŸ¥ç½‘ç»œè¿æ¥\n * - åˆçº¦è°ƒç”¨å¤±è´¥: ä½¿ç”¨é»˜è®¤å‚æ•°\n */\nasync function connectWallet() {\n    try {\n        // æ£€æŸ¥æ˜¯å¦å®‰è£…äº†Web3é’±åŒ… (MetaMaskç­‰)\n        if (window.ethereum) {\n            console.log(\"Web3é’±åŒ…å·²æ£€æµ‹åˆ°\");\n            \n            // è¯·æ±‚ç”¨æˆ·æˆæƒè¿æ¥é’±åŒ…\n            const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });\n            userAccount = accounts[0];\n            \n            // åˆ›å»ºWeb3å®ä¾‹\n            web3 = new Web3(window.ethereum);\n            \n            // åˆå§‹åŒ–æŠ½å¥–æ™ºèƒ½åˆçº¦å®ä¾‹\n            // åŠ¨æ€åŠ è½½ABIä¸éƒ¨ç½²åœ°å€\n            try {\n                const abi = await window.ContractConfig.loadLotteryAbi();\n                const addr = window.ContractConfig.lotteryAddress;\n                if (!addr) {\n                    console.error('Lotteryåˆçº¦åœ°å€æœªé…ç½®ï¼Œè¯·åœ¨ js/contract-config.js ä¸­å¡«å†™ lotteryAddress');\n                } else {\n                    lotteryContract = new web3.eth.Contract(abi, addr);\n                }\n            } catch (e) {\n                console.error('åŠ è½½Lottery ABIå¤±è´¥:', e);\n            }\n            \n            // ä»æ™ºèƒ½åˆçº¦è·å–æœ€æ–°çš„æŠ½å¥–æˆæœ¬\n            await updateDrawCostFromContract();\n            \n            // ç›‘å¬è´¦æˆ·å˜åŒ–äº‹ä»¶\n            window.ethereum.on('accountsChanged', handleAccountsChanged);\n            \n            // ç›‘å¬ç½‘ç»œå˜åŒ–äº‹ä»¶\n            window.ethereum.on('chainChanged', handleChainChanged);\n            \n            // æ›´æ–°è¿æ¥çŠ¶æ€\n            isConnected = true;\n            \n            // æ›´æ–°ç”¨æˆ·ç•Œé¢\n            // updateUI(); // ç°åœ¨ç”±WalletManagerå¤„ç†\n            \n            console.log(\"é’±åŒ…è¿æ¥æˆåŠŸ:\", userAccount);\n            \n        } else {\n            // é’±åŒ…æœªå®‰è£…çš„å¤„ç†\n            alert(\"è¯·å®‰è£…MetaMaské’±åŒ…ä»¥ä½¿ç”¨æŠ½å¥–åŠŸèƒ½ï¼\");\n            window.open(\"https://metamask.io/download/\", \"_blank\");\n        }\n    } catch (error) {\n        console.error(\"è¿æ¥é’±åŒ…å¤±è´¥:\", error);\n        \n        // æ ¹æ®é”™è¯¯ç±»å‹æ˜¾ç¤ºä¸åŒçš„æç¤ºä¿¡æ¯\n        if (error.code === 4001) {\n            alert(\"ç”¨æˆ·æ‹’ç»äº†é’±åŒ…è¿æ¥è¯·æ±‚\");\n        } else if (error.code === -32002) {\n            alert(\"é’±åŒ…è¿æ¥è¯·æ±‚å·²åœ¨å¤„ç†ä¸­ï¼Œè¯·æ£€æŸ¥MetaMask\");\n        } else {\n            alert(\"è¿æ¥é’±åŒ…æ—¶å‘ç”Ÿé”™è¯¯ï¼Œè¯·é‡è¯•\");\n        }\n        \n        // é‡ç½®è¿æ¥çŠ¶æ€\n        isConnected = false;\n        // updateUI(); // ç°åœ¨ç”±WalletManagerå¤„ç†\n    }\n}\n\n/**\n * ä»æ™ºèƒ½åˆçº¦æ›´æ–°æŠ½å¥–æˆæœ¬\n * è·å–åˆçº¦ä¸­è®¾ç½®çš„æœ€æ–°æŠ½å¥–è´¹ç”¨\n */\nasync function updateDrawCostFromContract() {\n    try {\n        const contractDrawCost = await lotteryContract.methods.drawCost().call();\n        drawCost = web3.utils.fromWei(contractDrawCost, 'ether');\n        console.log(\"åˆçº¦æŠ½å¥–æˆæœ¬:\", drawCost);\n        \n        // æ›´æ–°UIæ˜¾ç¤º\n        const costElement = document.getElementById('cost-amount');\n        if (costElement) {\n            costElement.textContent = drawCost;\n        }\n        \n        // æ›´æ–°æ€»è´¹ç”¨æ˜¾ç¤º\n        updateTotalCost();\n        \n    } catch (error) {\n        console.error(\"è·å–æŠ½å¥–æˆæœ¬å¤±è´¥:\", error);\n        // ä½¿ç”¨é»˜è®¤å€¼ï¼Œä¸å½±å“ç”¨æˆ·ä½“éªŒ\n        const costElement = document.getElementById('cost-amount');\n        if (costElement) {\n            costElement.textContent = drawCost;\n        }\n    }\n}\n\n/**\n * å¤„ç†è´¦æˆ·å˜åŒ–äº‹ä»¶\n * å½“ç”¨æˆ·åœ¨MetaMaskä¸­åˆ‡æ¢è´¦æˆ·æ—¶è§¦å‘\n */\nfunction handleAccountsChanged(accounts) {\n    if (accounts.length === 0) {\n        // ç”¨æˆ·æ–­å¼€äº†é’±åŒ…è¿æ¥\n        isConnected = false;\n        userAccount = null;\n        console.log(\"é’±åŒ…å·²æ–­å¼€è¿æ¥\");\n    } else {\n        // ç”¨æˆ·åˆ‡æ¢äº†è´¦æˆ·\n        userAccount = accounts[0];\n        console.log(\"è´¦æˆ·å·²åˆ‡æ¢:\", userAccount);\n    }\n    // updateUI(); // ç°åœ¨ç”±WalletManagerå¤„ç†\n}\n\n/**\n * å¤„ç†ç½‘ç»œå˜åŒ–äº‹ä»¶\n * å½“ç”¨æˆ·åœ¨MetaMaskä¸­åˆ‡æ¢ç½‘ç»œæ—¶è§¦å‘\n */\nfunction handleChainChanged(chainId) {\n    console.log(\"ç½‘ç»œå·²åˆ‡æ¢:\", chainId);\n    // é‡æ–°åŠ è½½é¡µé¢ä»¥ç¡®ä¿åº”ç”¨çŠ¶æ€æ­£ç¡®\n    window.location.reload();\n}\n\n/**\n * æ›´æ–°æŠ½å¥–æ¬¡æ•°\n * é€šè¿‡åŠ å‡æŒ‰é’®è°ƒæ•´æŠ½å¥–æ¬¡æ•°\n * @param {number} change - å˜åŒ–é‡ (+1 æˆ– -1)\n */\nfunction updateDrawTimes(change) {\n    const input = document.getElementById('draw-times-input');\n    let newValue = parseInt(input.value) + change;\n    \n    // ç¡®ä¿æ¬¡æ•°åœ¨æœ‰æ•ˆèŒƒå›´å†… (1-100æ¬¡)\n    if (newValue < 1) newValue = 1;\n    if (newValue > 100) newValue = 100;\n    \n    input.value = newValue;\n    drawTimes = newValue;\n    updateTotalCost();\n}\n\n/**\n * éªŒè¯æŠ½å¥–æ¬¡æ•°è¾“å…¥\n * å½“ç”¨æˆ·ç›´æ¥åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æ•°å­—æ—¶è¿›è¡ŒéªŒè¯\n */\nfunction validateDrawTimes() {\n    const input = document.getElementById('draw-times-input');\n    let value = parseInt(input.value);\n    \n    // ç¡®ä¿è¾“å…¥æ˜¯æœ‰æ•ˆæ•°å­—ä¸”åœ¨å…è®¸èŒƒå›´å†…\n    if (isNaN(value) || value < 1) {\n        value = 1;\n    } else if (value > 100) {\n        value = 100;\n    }\n    \n    input.value = value;\n    drawTimes = value;\n    updateTotalCost();\n}\n\n/**\n * æ›´æ–°æ€»èŠ±è´¹æ˜¾ç¤º\n * æ ¹æ®æŠ½å¥–æ¬¡æ•°å’Œå•æ¬¡è´¹ç”¨è®¡ç®—æ€»è´¹ç”¨\n */\nfunction updateTotalCost() {\n    const totalCost = drawTimes * drawCost;\n    const totalCostElement = document.getElementById('total-cost-amount');\n    if (totalCostElement) {\n        totalCostElement.textContent = totalCost;\n    }\n}\n\n/**\n * å¼€å§‹æŠ½å¥–åŠŸèƒ½\n * æ‰§è¡ŒæŠ½å¥–æµç¨‹ï¼ŒåŒ…æ‹¬æ™ºèƒ½åˆçº¦äº¤äº’å’Œç»“æœå¤„ç†\n * \n * æŠ½å¥–æµç¨‹:\n * 1. éªŒè¯é’±åŒ…è¿æ¥çŠ¶æ€\n * 2. æ£€æŸ¥ç”¨æˆ·ä»£å¸ä½™é¢\n * 3. è°ƒç”¨æ™ºèƒ½åˆçº¦æ‰§è¡ŒæŠ½å¥–\n * 4. å¤„ç†æŠ½å¥–ç»“æœå’ŒåŠ¨ç”»\n * 5. æ›´æ–°ç”¨æˆ·ç•Œé¢å’Œå†å²è®°å½•\n * \n * æ™ºèƒ½åˆçº¦äº¤äº’:\n * - æ£€æŸ¥ç”¨æˆ·XWAWAä»£å¸ä½™é¢\n * - æˆæƒåˆçº¦æ‰£é™¤ä»£å¸\n * - è°ƒç”¨æŠ½å¥–åˆçº¦æ–¹æ³•\n * - ç›‘å¬æŠ½å¥–ç»“æœäº‹ä»¶\n * \n * åç«¯APIè°ƒç”¨:\n * - POST /api/lottery/draw - è®°å½•æŠ½å¥–å†å²\n * - PUT /api/users/balance - æ›´æ–°ç”¨æˆ·ä½™é¢\n */\nasync function startDraw() {\n    // æ£€æŸ¥é’±åŒ…è¿æ¥çŠ¶æ€\n    if (!isConnected) {\n        alert('è¯·å…ˆè¿æ¥é’±åŒ…');\n        return;\n    }\n    \n    // é˜²æ­¢é‡å¤æŠ½å¥–\n    if (isSpinning) {\n        return;\n    }\n    \n    // è®¾ç½®æŠ½å¥–çŠ¶æ€ï¼Œç¦ç”¨æŠ½å¥–æŒ‰é’®\n    isSpinning = true;\n    const drawButton = document.getElementById('draw-button');\n    if (drawButton) {\n        drawButton.disabled = true;\n        drawButton.textContent = 'æŠ½å¥–ä¸­...';\n    }\n    \n    try {\n        const txReceipt = await drawFromContract(drawTimes);\n        startMagicAnimation();\n        playSpinSound();\n        const placeholder = prizes[Math.floor(Math.random() * prizes.length)];\n        spinWheel(placeholder.id);\n        setTimeout(() => {\n            if (placeholder.id <= 4) {\n                addWinEffect(placeholder.id);\n            }\n            showResultModal(placeholder);\n            addResultsToList([placeholder]);\n            resetDrawState();\n        }, 5200);\n    } catch (error) {\n        console.error('æŠ½å¥–å¤±è´¥:', error);\n        alert('æŠ½å¥–å¤±è´¥ï¼Œè¯·é‡è¯•');\n        resetDrawState();\n    }\n}\n\n/**\n * é‡ç½®æŠ½å¥–çŠ¶æ€\n * æ¢å¤æŠ½å¥–æŒ‰é’®å’Œç›¸å…³UIçŠ¶æ€\n */\nfunction resetDrawState() {\n    isSpinning = false;\n    const drawButton = document.getElementById('draw-button');\n    if (drawButton) {\n        drawButton.disabled = false;\n        drawButton.textContent = 'å¼€å§‹æŠ½å¥–';\n    }\n}\n\n/**\n * è·å–ç”¨æˆ·ä»£å¸ä½™é¢\n * ä»XWAWAä»£å¸åˆçº¦æŸ¥è¯¢ç”¨æˆ·ä½™é¢\n * @returns {Promise<number>} ç”¨æˆ·ä»£å¸ä½™é¢\n */\nasync function getUserTokenBalance() {\n    try {\n        const xwawaContract = await getXwawaContract();\n        const balance = await xwawaContract.methods.balanceOf(userAccount).call();\n        return parseFloat(web3.utils.fromWei(balance, 'ether'));\n    } catch (error) {\n        console.error(\"è·å–ç”¨æˆ·ä½™é¢å¤±è´¥:\", error);\n        return 0;\n    }\n}\n\n/**\n * æ›´æ–°UIçŠ¶æ€\n */\nfunction updateUI() {\n    const walletStatus = document.getElementById('wallet-status');\n    const connectButton = document.getElementById('connect-wallet-btn');\n    const drawButton = document.getElementById('draw-button');\n\n    if (isConnected) {\n        walletStatus.textContent = `å·²è¿æ¥: ${shortenAddress(userAccount)}`;\n        walletStatus.className = 'connected';\n        connectButton.textContent = 'å·²è¿æ¥';\n        connectButton.disabled = true;\n        drawButton.disabled = false;\n    } else {\n        walletStatus.textContent = 'æœªè¿æ¥é’±åŒ…';\n        walletStatus.className = 'not-connected';\n        connectButton.textContent = 'è¿æ¥é’±åŒ…';\n        connectButton.disabled = false;\n        drawButton.disabled = true;\n    }\n\n    // æ›´æ–°æŠ½å¥–æˆæœ¬å’Œæ€»æˆæœ¬\n    document.getElementById('cost-amount').textContent = drawCost;\n    updateTotalCost();\n}\n\n/**\n * ç¼©çŸ­åœ°å€æ˜¾ç¤º\n * @param {string} address - é’±åŒ…åœ°å€\n * @returns {string} ç¼©çŸ­åçš„åœ°å€\n */\nfunction shortenAddress(address) {\n    return `${address.substring(0, 6)}...${address.substring(address.length - 4)}`;\n}\n\n/**\n * æ¨¡æ‹ŸæŠ½å¥–ç»“æœç”Ÿæˆ (ä»…ç”¨äºå¼€å‘æµ‹è¯•)\n * å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç»“æœåº”å®Œå…¨ç”±æ™ºèƒ½åˆçº¦ç”Ÿæˆ\n * @returns {Array} æŠ½å¥–ç»“æœæ•°ç»„\n */\nfunction generateMockResults() {\n    const results = [];\n    for (let i = 0; i < drawTimes; i++) {\n        // éšæœºé€‰æ‹©ä¸€ä¸ªå¥–é¡¹ (ä»…ç”¨äºå‰ç«¯å±•ç¤º)\n        const result = getRandomPrize();\n        results.push(result);\n            \n        // å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡æŠ½å¥–ï¼Œæ—‹è½¬è½¬ç›˜\n        if (i === 0) {\n            spinWheel(result.id);\n        }\n    }\n        \n    // æ·»åŠ æŠ½å¥–ç»“æœåˆ°ç»“æœåˆ—è¡¨\n    addResultsToList(results);\n        \n    // å¦‚æœåªæŠ½å¥–ä¸€æ¬¡ï¼Œæ˜¾ç¤ºç»“æœå¼¹çª—\n    if (drawTimes === 1) {\n        setTimeout(() => {\n            showResultModal(results[0]);\n        }, 5500); // ç­‰å¾…è½¬ç›˜åœæ­¢åæ˜¾ç¤º\n    }\n        \n    console.log(\"æŠ½å¥–å®Œæˆï¼Œç»“æœ:\", results);\n    try {\n        console.error(\"æŠ½å¥–å¤±è´¥:\", error);\n        alert('æŠ½å¥–å¤±è´¥ï¼Œè¯·é‡è¯•');\n        isSpinning = false;\n        document.getElementById('draw-button').disabled = false;\n    }\n    catch (error) {\n        console.error(\"æŠ½å¥–å¤±è´¥:\", error);\n        alert('æŠ½å¥–å¤±è´¥ï¼Œè¯·é‡è¯•');\n        isSpinning = false;\n        document.getElementById('draw-button').disabled = false;\n    }\n\n    // è·å–éšæœºå¥–é¡¹\n    function getRandomPrize() {\n        const random = Math.random();\n        let cumulativeProbability = 0;\n    \n        for (const prize of prizes) {\n            cumulativeProbability += prize.probability;\n            if (random <= cumulativeProbability) {\n                return prize;\n            }\n        }\n    \n        // é»˜è®¤è¿”å›æœ€åä¸€ä¸ªå¥–é¡¹\n        return prizes[prizes.length - 1];\n    }\n\n    // é­”æ³•è½¬ç›˜æ—‹è½¬ - é­”æ³•ä¸»é¢˜ä¼˜åŒ–ç‰ˆæœ¬\n    function spinWheel(prizeId) {\n        const wheel = document.querySelector('.wheel-inner');\n        const wheelContainer = document.querySelector('.lottery-wheel-container');\n        const pointer = document.querySelector('.wheel-pointer');\n        const wheelAura = document.querySelector('.wheel-magic-aura');\n    \n        // æ·»åŠ é­”æ³•æ—‹è½¬å¼€å§‹çš„è§†è§‰æ•ˆæœ\n        wheelContainer.classList.add('spinning', 'magic-spinning');\n        pointer.classList.add('pointer-active');\n        \n        // æ¿€æ´»é­”æ³•å…‰ç¯\n        if (wheelAura) {\n            wheelAura.classList.add('spinning-aura');\n        }\n    \n        // è®¡ç®—æ—‹è½¬è§’åº¦\n        // æ¯ä¸ªå¥–é¡¹å 60åº¦ï¼Œè®¡ç®—ç›®æ ‡å¥–é¡¹çš„ä¸­å¿ƒè§’åº¦\n        const targetAngle = (prizeId - 1) * 60 + 30;\n    \n        // æ·»åŠ éšæœºçš„é¢å¤–æ—‹è½¬åœˆæ•° (8-12åœˆï¼Œæ›´å¤šåœˆæ•°å¢åŠ é­”æ³•æ„Ÿ)\n        const extraRotations = (8 + Math.random() * 4) * 360;\n    \n        // æœ€ç»ˆæ—‹è½¬è§’åº¦ = é¢å¤–åœˆæ•° + (360 - ç›®æ ‡è§’åº¦)\n        const finalRotation = extraRotations + (360 - targetAngle);\n    \n        // åº”ç”¨é­”æ³•æ—‹è½¬åŠ¨ç”» - æ›´é•¿çš„åŠ¨ç”»æ—¶é—´å’Œé­”æ³•æ›²çº¿\n        wheel.style.transition = 'transform 5s cubic-bezier(0.23, 1, 0.32, 1)';\n        wheel.style.transform = `rotate(${finalRotation}deg)`;\n    \n        // æ·»åŠ éŸ³æ•ˆå’Œéœ‡åŠ¨æ•ˆæœ (å¦‚æœæ”¯æŒ)\n        playSpinSound();\n        addVibration();\n        \n        // åˆ›å»ºé­”æ³•æ—‹è½¬ç²’å­æ•ˆæœ\n        createSpinningMagicParticles();\n    \n        // åŠ¨ç”»è¿‡ç¨‹ä¸­çš„é­”æ³•æ•ˆæœ\n        setTimeout(() => {\n            // ä¸­é€”æ·»åŠ é­”æ³•èƒ½é‡çˆ†å‘\n            wheelContainer.classList.add('mid-spin', 'magic-burst');\n            createMagicEnergyWave();\n        }, 2500);\n    \n        // åŠ¨ç”»ç»“æŸåçš„å¤„ç†\n        setTimeout(() => {\n            isSpinning = false;\n            wheelContainer.classList.remove('spinning', 'mid-spin', 'magic-spinning', 'magic-burst');\n            pointer.classList.remove('pointer-active');\n            wheelContainer.classList.add('spin-complete');\n            \n            if (wheelAura) {\n                wheelAura.classList.remove('spinning-aura');\n            }\n        \n            // æ·»åŠ è·å¥–æ•ˆæœ\n            addWinEffect(prizeId);\n        \n            document.getElementById('draw-button').disabled = false;\n        \n            // æ¸…é™¤å®ŒæˆçŠ¶æ€\n            setTimeout(() => {\n                wheelContainer.classList.remove('spin-complete');\n            }, 1000);\n        }, 5000); // å»¶é•¿åˆ°5ç§’åŒ¹é…æ–°çš„åŠ¨ç”»æ—¶é—´\n    }\n\n    // æ’­æ”¾æ—‹è½¬éŸ³æ•ˆ\n    function playSpinSound() {\n        try {\n            // åˆ›å»ºéŸ³é¢‘ä¸Šä¸‹æ–‡æ¥æ’­æ”¾ç®€å•çš„éŸ³æ•ˆ\n            const audioContext = new (window.AudioContext || window.webkitAudioContext)();\n            const oscillator = audioContext.createOscillator();\n            const gainNode = audioContext.createGain();\n        \n            oscillator.connect(gainNode);\n            gainNode.connect(audioContext.destination);\n        \n            oscillator.frequency.setValueAtTime(200, audioContext.currentTime);\n            oscillator.frequency.exponentialRampToValueAtTime(100, audioContext.currentTime + 0.1);\n        \n            gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);\n            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);\n        \n            oscillator.start(audioContext.currentTime);\n            oscillator.stop(audioContext.currentTime + 0.1);\n        } catch (e) {\n            // å¦‚æœéŸ³é¢‘APIä¸æ”¯æŒï¼Œé™é»˜å¤±è´¥\n            console.log('Audio not supported');\n        }\n    }\n\n    // æ·»åŠ éœ‡åŠ¨æ•ˆæœ\n    function addVibration() {\n        if ('vibrate' in navigator) {\n            navigator.vibrate([100, 50, 100]);\n        }\n    }\n\n    // æ·»åŠ è·å¥–æ•ˆæœ\n    function addWinEffect(prizeId) {\n        const wheelContainer = document.querySelector('.lottery-wheel-container');\n    \n        // æ ¹æ®å¥–é¡¹ç­‰çº§æ·»åŠ ä¸åŒçš„æ•ˆæœ\n        if (prizeId <= 3) {\n            // é«˜çº§å¥–é¡¹ï¼šæ·»åŠ é—ªå…‰æ•ˆæœ\n            wheelContainer.classList.add('major-win');\n            createFireworks();\n            setTimeout(() => {\n                wheelContainer.classList.remove('major-win');\n            }, 3000);\n        } else if (prizeId <= 5) {\n            // ä¸­çº§å¥–é¡¹ï¼šæ·»åŠ å‘å…‰æ•ˆæœ\n            wheelContainer.classList.add('minor-win');\n            setTimeout(() => {\n                wheelContainer.classList.remove('minor-win');\n            }, 2000);\n        }\n    }\n\n    // åˆ›å»ºçƒŸèŠ±æ•ˆæœ\n    function createFireworks() {\n        const container = document.querySelector('.lottery-wheel-container');\n    \n        for (let i = 0; i < 20; i++) {\n            setTimeout(() => {\n                const particle = document.createElement('div');\n                particle.className = 'firework-particle';\n                particle.style.left = Math.random() * 100 + '%';\n                particle.style.top = Math.random() * 100 + '%';\n                container.appendChild(particle);\n            \n                setTimeout(() => {\n                    particle.remove();\n                }, 1000);\n            }, i * 100);\n        }\n    }\n\n    // æ·»åŠ ç»“æœåˆ°åˆ—è¡¨\n    function addResultsToList(results) {\n        const resultsList = document.querySelector('.results-list');\n        const noResults = document.querySelector('.no-results');\n    \n        if (noResults) {\n            noResults.style.display = 'none';\n        }\n    \n        results.forEach(result => {\n            const resultItem = document.createElement('div');\n            resultItem.className = `result-item ${result.className}`;\n        \n            resultItem.innerHTML = `\n            <span class=\"result-name\">${result.name}</span>\n            <span class=\"result-value\">${new Date().toLocaleTimeString()}</span>\n        `;\n        \n            resultsList.prepend(resultItem);\n        });\n    }\n\n    // æ˜¾ç¤ºç»“æœå¼¹çª—\n    function showResultModal(result) {\n        const modal = document.getElementById('result-modal');\n        const resultTitle = document.getElementById('result-title');\n        const resultMessage = document.getElementById('result-message');\n        const resultIcon = document.getElementById('result-icon');\n    \n        // è®¾ç½®ç»“æœä¿¡æ¯\n        resultTitle.textContent = `æ­å–œè·å¾—: ${result.name}`;\n        resultMessage.textContent = getResultMessage(result.id);\n        resultIcon.textContent = getResultIcon(result.id);\n        resultIcon.style.color = result.color;\n    \n        // æ˜¾ç¤ºå¼¹çª—\n        modal.style.display = 'block';\n    }\n\n    // å…³é—­ç»“æœå¼¹çª— - ç§»é™¤ï¼Œå°†åœ¨æ–‡ä»¶é¡¶éƒ¨é‡æ–°å®šä¹‰\n\n    // è·å–ç»“æœæ¶ˆæ¯\n    function getResultMessage(prizeId) {\n        switch (prizeId) {\n            case 1:\n                return \"æ­å–œæ‚¨è·å¾—ä¸€ç­‰å¥–ï¼å¥–åŠ±å·²å‘æ”¾åˆ°æ‚¨çš„è´¦æˆ·ã€‚\";\n            case 2:\n                return \"æ­å–œæ‚¨è·å¾—äºŒç­‰å¥–ï¼å¥–åŠ±å·²å‘æ”¾åˆ°æ‚¨çš„è´¦æˆ·ã€‚\";\n            case 3:\n                return \"æ­å–œæ‚¨è·å¾—ä¸‰ç­‰å¥–ï¼å¥–åŠ±å·²å‘æ”¾åˆ°æ‚¨çš„è´¦æˆ·ã€‚\";\n            case 4:\n                return \"æ‚¨è·å¾—äº†å¥–æ± åˆ†çº¢ï¼å¥–åŠ±å·²å‘æ”¾åˆ°æ‚¨çš„è´¦æˆ·ã€‚\";\n            case 5:\n                return \"æ‚¨è·å¾—äº†åŒå€æŠ½å¥–æœºä¼šï¼ä¸‹æ¬¡æŠ½å¥–å°†è·å¾—åŒå€å¥–åŠ±ã€‚\";\n            case 6:\n                return \"è°¢è°¢å‚ä¸ï¼Œä¸‹æ¬¡å†æ¥å†å‰ï¼\";\n            default:\n                return \"æŠ½å¥–ç»“æœæœªçŸ¥ï¼Œè¯·è”ç³»å®¢æœã€‚\";\n        }\n    }\n\n    // è·å–ç»“æœå›¾æ ‡\n    function getResultIcon(prizeId) {\n        switch (prizeId) {\n            case 1:\n                return \"ğŸ†\";\n            case 2:\n                return \"ğŸ¥ˆ\";\n            case 3:\n                return \"ğŸ¥‰\";\n            case 4:\n                return \"ğŸ’°\";\n            case 5:\n                return \"ğŸ¯\";\n            case 6:\n                return \"ğŸ˜Š\";\n            default:\n                return \"â“\";\n        }\n    }\n\n\n}\n\n    /**\n     * ä»¥ä¸‹æ˜¯ä¸æ™ºèƒ½åˆçº¦äº¤äº’çš„å‡½æ•°\n     * æ³¨æ„: è¿™äº›å‡½æ•°éœ€è¦æ ¹æ®å®é™…çš„åˆçº¦ABIè¿›è¡Œè°ƒæ•´\n     * \n     * åˆçº¦å‡½æ•°è¯´æ˜:\n     * 1. draw(): è¿›è¡Œä¸€æ¬¡æŠ½å¥–ï¼Œè¿”å›æŠ½å¥–ç»“æœ\n     * 2. drawCost(): è·å–æ¯æ¬¡æŠ½å¥–çš„æˆæœ¬\n     * 3. drawTimes(): è·å–ç”¨æˆ·çš„æŠ½å¥–æ¬¡æ•°\n     * 4. XWAWA_COIN(): è·å–Xwawaä»£å¸åˆçº¦åœ°å€\n     * \n     * è¿™äº›å‡½æ•°åœ¨å®é™…éƒ¨ç½²æ—¶éœ€è¦æ ¹æ®Lottery.abiæ–‡ä»¶ä¸­çš„å®é™…åˆçº¦æ¥å£è¿›è¡Œè°ƒæ•´\n     */\n\n    // å®é™…è°ƒç”¨åˆçº¦çš„drawå‡½æ•°\n    async function drawFromContract(times) {\n        try {\n            const tx = await lotteryContract.methods.draw(times).send({ from: userAccount });\n            return tx;\n        } catch (error) {\n            console.error(\"åˆçº¦æŠ½å¥–å¤±è´¥:\", error);\n            throw error;\n        }\n    }\n\n    // è·å–Xwawaä»£å¸åˆçº¦\n    async function getXwawaContract() {\n        try {\n            const xwawaAddress = await lotteryContract.methods.XWAWA_COIN().call();\n        \n            // è¿™é‡Œéœ€è¦Xwawaä»£å¸çš„ABIï¼Œè¿™åªæ˜¯ä¸€ä¸ªç¤ºä¾‹\n            const xwawaABI = [\n                {\n                    \"constant\": true,\n                    \"inputs\": [{ \"name\": \"_owner\", \"type\": \"address\" }],\n                    \"name\": \"balanceOf\",\n                    \"outputs\": [{ \"name\": \"balance\", \"type\": \"uint256\" }],\n                    \"type\": \"function\"\n                },\n                {\n                    \"constant\": false,\n                    \"inputs\": [\n                        { \"name\": \"_spender\", \"type\": \"address\" },\n                        { \"name\": \"_value\", \"type\": \"uint256\" }\n                    ],\n                    \"name\": \"approve\",\n                    \"outputs\": [{ \"name\": \"\", \"type\": \"bool\" }],\n                    \"type\": \"function\"\n                }\n            ];\n        \n            return new web3.eth.Contract(xwawaABI, xwawaAddress);\n        } catch (error) {\n            console.error(\"è·å–Xwawaåˆçº¦å¤±è´¥:\", error);\n            throw error;\n        }\n    }\n\n/**\n * é­”æ³•å¸ˆXwawaåŠ¨ç”»ç³»ç»Ÿ\n * å®ç°é­”æ³•æ£’æŒ¥åŠ¨ã€é­”æ³•ç²’å­æ•ˆæœå’Œè½¬ç›˜é­”æ³•åŒ–\n */\n\n// å¯åŠ¨é­”æ³•åŠ¨ç”»åºåˆ—\nfunction startMagicAnimation() {\n    const magicWizard = document.querySelector('.magic-wizard');\n    const magicWand = document.querySelector('.magic-wand');\n    const magicArm = document.querySelector('#magic-arm');\n    const magicParticles = document.querySelector('.magic-particles');\n    const magicSpell = document.querySelector('.magic-spell');\n    const wheelAura = document.querySelector('.wheel-magic-aura');\n    \n    if (!magicWizard) return;\n    \n    // 1. é­”æ³•å¸ˆå‡†å¤‡æ–½æ³•\n    magicWizard.classList.add('casting');\n    \n    // 2. æ˜¾ç¤ºé­”æ³•å’’è¯­\n    if (magicSpell) {\n        magicSpell.style.opacity = '1';\n        magicSpell.style.transform = 'translateY(-10px)';\n    }\n    \n    // 3. æ‰‹è‡‚å’Œé­”æ³•æ£’å¼€å§‹æŒ¥åŠ¨\n    setTimeout(() => {\n        // æ‰‹è‡‚æŒ¥åŠ¨åŠ¨ç”»\n        if (magicArm) {\n            magicArm.classList.add('casting');\n        }\n        \n        // é­”æ³•æ£’æŒ¥åŠ¨åŠ¨ç”»\n        if (magicWand) {\n            magicWand.classList.add('waving');\n        }\n        \n        // æ¿€æ´»é­”æ³•ç²’å­æ•ˆæœ\n        if (magicParticles) {\n            magicParticles.classList.add('active');\n        }\n        \n        // æ’­æ”¾é­”æ³•éŸ³æ•ˆ\n        playMagicSound();\n        \n    }, 500);\n    \n    // 4. è½¬ç›˜è·å¾—é­”æ³•å…‰ç¯\n    setTimeout(() => {\n        if (wheelAura) {\n            wheelAura.classList.add('active');\n        }\n        \n        // åˆ›å»ºé­”æ³•ç²’å­çˆ†å‘æ•ˆæœ\n        createMagicBurst();\n        \n    }, 1000);\n    \n    // 5. åŠ¨ç”»ç»“æŸåé‡ç½®çŠ¶æ€\n    setTimeout(() => {\n        resetMagicAnimation();\n    }, 6000);\n}\n\n// é‡ç½®é­”æ³•åŠ¨ç”»çŠ¶æ€\nfunction resetMagicAnimation() {\n    const magicWizard = document.querySelector('.magic-wizard');\n    const magicWand = document.querySelector('.magic-wand');\n    const magicArm = document.querySelector('#magic-arm');\n    const magicParticles = document.querySelector('.magic-particles');\n    const magicSpell = document.querySelector('.magic-spell');\n    const wheelAura = document.querySelector('.wheel-magic-aura');\n    \n    if (magicWizard) magicWizard.classList.remove('casting');\n    if (magicWand) magicWand.classList.remove('waving');\n    if (magicArm) magicArm.classList.remove('casting');\n    if (magicParticles) magicParticles.classList.remove('active');\n    if (wheelAura) wheelAura.classList.remove('active');\n    \n    if (magicSpell) {\n        magicSpell.style.opacity = '0';\n        magicSpell.style.transform = 'translateY(0)';\n    }\n}\n\n// æ’­æ”¾é­”æ³•éŸ³æ•ˆ\nfunction playMagicSound() {\n    try {\n        const audioContext = new (window.AudioContext || window.webkitAudioContext)();\n        \n        // åˆ›å»ºé­”æ³•éŸ³æ•ˆåºåˆ—\n        const frequencies = [440, 554, 659, 880]; // A4, C#5, E5, A5 - é­”æ³•å’Œå¼¦\n        \n        frequencies.forEach((freq, index) => {\n            setTimeout(() => {\n                const oscillator = audioContext.createOscillator();\n                const gainNode = audioContext.createGain();\n                \n                oscillator.connect(gainNode);\n                gainNode.connect(audioContext.destination);\n                \n                oscillator.frequency.setValueAtTime(freq, audioContext.currentTime);\n                oscillator.type = 'sine';\n                \n                gainNode.gain.setValueAtTime(0, audioContext.currentTime);\n                gainNode.gain.linearRampToValueAtTime(0.1, audioContext.currentTime + 0.1);\n                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);\n                \n                oscillator.start(audioContext.currentTime);\n                oscillator.stop(audioContext.currentTime + 0.5);\n            }, index * 150);\n        });\n        \n    } catch (e) {\n        console.log('Magic audio not supported');\n    }\n}\n\n// åˆ›å»ºé­”æ³•ç²’å­çˆ†å‘æ•ˆæœ\nfunction createMagicBurst() {\n    const wheelContainer = document.querySelector('.lottery-wheel-container');\n    if (!wheelContainer) return;\n    \n    // åˆ›å»ºå¤šä¸ªé­”æ³•ç²’å­\n    for (let i = 0; i < 30; i++) {\n        setTimeout(() => {\n            const particle = document.createElement('div');\n            particle.className = 'magic-burst-particle';\n            \n            // éšæœºä½ç½®å’Œé¢œè‰²\n            const colors = ['#FFD700', '#FF69B4', '#00FFFF', '#FF6347', '#98FB98'];\n            particle.style.background = colors[Math.floor(Math.random() * colors.length)];\n            particle.style.left = (50 + (Math.random() - 0.5) * 60) + '%';\n            particle.style.top = (50 + (Math.random() - 0.5) * 60) + '%';\n            \n            // éšæœºè¿åŠ¨æ–¹å‘\n            const angle = Math.random() * Math.PI * 2;\n            const distance = 100 + Math.random() * 100;\n            const endX = Math.cos(angle) * distance;\n            const endY = Math.sin(angle) * distance;\n            \n            particle.style.setProperty('--end-x', endX + 'px');\n            particle.style.setProperty('--end-y', endY + 'px');\n            \n            wheelContainer.appendChild(particle);\n            \n            // ç²’å­åŠ¨ç”»\n            setTimeout(() => {\n                particle.style.transform = `translate(var(--end-x), var(--end-y)) scale(0)`;\n                particle.style.opacity = '0';\n            }, 50);\n            \n            // æ¸…ç†ç²’å­\n            setTimeout(() => {\n                if (particle.parentNode) {\n                    particle.parentNode.removeChild(particle);\n                }\n            }, 2000);\n            \n        }, i * 50);\n    }\n}\n\n// åˆ›å»ºé­”æ³•æ—‹è½¬ç²’å­æ•ˆæœ\nfunction createSpinningMagicParticles() {\n    const wheelContainer = document.querySelector('.lottery-wheel-container');\n    if (!wheelContainer) return;\n    \n    // åˆ›å»ºå›´ç»•è½¬ç›˜æ—‹è½¬çš„é­”æ³•ç²’å­\n    for (let i = 0; i < 20; i++) {\n        setTimeout(() => {\n            const particle = document.createElement('div');\n            particle.className = 'spinning-magic-particle';\n            \n            // é­”æ³•é¢œè‰²\n            const colors = ['#FFD700', '#FF69B4', '#00FFFF', '#9370DB', '#FF6347'];\n            particle.style.background = colors[Math.floor(Math.random() * colors.length)];\n            \n            // è®¾ç½®åˆå§‹ä½ç½®ï¼ˆåœ†å½¢è½¨é“ï¼‰\n            const angle = (i / 20) * Math.PI * 2;\n            const radius = 150;\n            const x = 50 + Math.cos(angle) * radius / 4; // è½¬æ¢ä¸ºç™¾åˆ†æ¯”\n            const y = 50 + Math.sin(angle) * radius / 4;\n            \n            particle.style.left = x + '%';\n            particle.style.top = y + '%';\n            particle.style.setProperty('--orbit-angle', angle + 'rad');\n            \n            wheelContainer.appendChild(particle);\n            \n            // æ¸…ç†ç²’å­\n            setTimeout(() => {\n                if (particle.parentNode) {\n                    particle.parentNode.removeChild(particle);\n                }\n            }, 5000);\n            \n        }, i * 100);\n    }\n}\n\n// åˆ›å»ºé­”æ³•èƒ½é‡æ³¢æ•ˆæœ\nfunction createMagicEnergyWave() {\n    const wheelContainer = document.querySelector('.lottery-wheel-container');\n    if (!wheelContainer) return;\n    \n    // åˆ›å»ºèƒ½é‡æ³¢\n    for (let i = 0; i < 3; i++) {\n        setTimeout(() => {\n            const wave = document.createElement('div');\n            wave.className = 'magic-energy-wave';\n            \n            // è®¾ç½®æ³¢çš„é¢œè‰²\n            const colors = ['#FFD700', '#FF69B4', '#00FFFF'];\n            wave.style.borderColor = colors[i];\n            wave.style.left = '50%';\n            wave.style.top = '50%';\n            wave.style.transform = 'translate(-50%, -50%)';\n            \n            wheelContainer.appendChild(wave);\n            \n            // æ³¢åŠ¨ç”»\n            setTimeout(() => {\n                wave.style.width = '400px';\n                wave.style.height = '400px';\n                wave.style.opacity = '0';\n            }, 50);\n            \n            // æ¸…ç†æ³¢\n            setTimeout(() => {\n                if (wave.parentNode) {\n                    wave.parentNode.removeChild(wave);\n                }\n            }, 1500);\n            \n        }, i * 300);\n    }\n}\n\n/**\n * æ³¨æ„äº‹é¡¹:\n * 1. æœ¬ä»£ç ä»…ä¸ºå‰ç«¯å®ç°ï¼Œå®é™…ä½¿ç”¨æ—¶éœ€è¦ä¸åç«¯å’ŒåŒºå—é“¾è¿›è¡Œäº¤äº’\n * 2. åˆçº¦è°ƒç”¨éƒ¨åˆ†éœ€è¦æ ¹æ®å®é™…éƒ¨ç½²çš„åˆçº¦è¿›è¡Œè°ƒæ•´\n * 3. æŠ½å¥–ç»“æœåº”è¯¥ç”±åˆçº¦è¿”å›ï¼Œè€Œä¸æ˜¯å‰ç«¯éšæœºç”Ÿæˆ\n * 4. ç”¨æˆ·éœ€è¦æˆæƒåˆçº¦ä½¿ç”¨å…¶Xwawaä»£å¸\n * 5. æŠ½å¥–æˆæœ¬å’Œå¥–é¡¹é…ç½®åº”è¯¥ä»åˆçº¦ä¸­è·å–\n * \n * åç«¯å¼€å‘äººå‘˜éœ€è¦:\n * 1. éƒ¨ç½²Lotteryåˆçº¦\n * 2. ç¡®ä¿åˆçº¦ä¸­æœ‰æ­£ç¡®çš„drawã€drawCostç­‰å‡½æ•°\n * 3. è®¾ç½®æ­£ç¡®çš„Xwawaä»£å¸åœ°å€\n * 4. å®ç°åŒºå—é“¾äº¤æ˜“ç›‘å¬åŠŸèƒ½\n*/\n"]}