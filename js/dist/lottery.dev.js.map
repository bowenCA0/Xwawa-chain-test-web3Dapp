{"version":3,"sources":["lottery.js"],"names":["web3","lotteryContract","userAccount","isConnected","drawTimes","drawCost","isSpinning","prizes","id","name","probability","color","className","lotteryABI","lotteryContractAddress","xwawaTokenAddress","document","addEventListener","updateUI","getElementById","connectWallet","startDraw","updateDrawTimes","validateDrawTimes","querySelectorAll","forEach","element","closeResultModal","initLanguageSwitch","checkWalletConnection","languageSwitch","lang","checked","switchLanguage","localStorage","setItem","savedLang","getItem","elements","hasAttribute","textContent","getAttribute","window","ethereum","request","method","accounts","length","Web3","eth","Contract","updateDrawCostFromContract","console","error","log","on","handleAccountsChanged","handleChainChanged","alert","open","code","methods","call","contractDrawCost","utils","fromWei","costElement","updateTotalCost","chainId","location","reload","change","input","newValue","parseInt","value","isNaN","totalCost","totalCostElement","drawButton","disabled","getUserTokenBalance","userBalance","drawFromContract","results","playSpinSound","spinWheel","setTimeout","addWinEffect","showResultModal","addResultsToList","resetDrawState","getXwawaContract","xwawaContract","balanceOf","balance","parseFloat","generateMockResults","i","result","getRandomPrize","push","random","Math","cumulativeProbability","prize","prizeId","wheel","querySelector","wheelContainer","pointer","classList","add","targetAngle","extraRotations","finalRotation","style","transition","transform","addVibration","remove","audioContext","AudioContext","webkitAudioContext","oscillator","createOscillator","gainNode","createGain","connect","destination","frequency","setValueAtTime","currentTime","exponentialRampToValueAtTime","gain","start","stop","e","navigator","vibrate","createFireworks","container","particle","createElement","left","top","appendChild","resultsList","noResults","display","resultItem","innerHTML","Date","toLocaleTimeString","prepend","modal","resultTitle","resultMessage","resultIcon","getResultMessage","getResultIcon","walletStatus","connectButton","shortenAddress","address","substring","requiredAmount","toWei","toString","approve","send","from","draw","XWAWA_COIN","xwawaAddress","xwawaABI"],"mappings":"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","sourcesContent":["/**\n * Xwawa æŠ½å¥–ç³»ç»Ÿ - æ ¸å¿ƒJavaScriptåŠŸèƒ½å®ç°\n * \n * ä¸»è¦åŠŸèƒ½:\n * 1. Web3é’±åŒ…è¿æ¥ (MetaMaskç­‰)\n * 2. æ™ºèƒ½åˆçº¦äº¤äº’ (æŠ½å¥–åˆçº¦ã€ä»£å¸åˆçº¦)\n * 3. æŠ½å¥–è½¬ç›˜åŠ¨ç”»å’ŒéŸ³æ•ˆ\n * 4. æŠ½å¥–ç»“æœå¤„ç†å’Œæ˜¾ç¤º\n * 5. ç”¨æˆ·ç•Œé¢çŠ¶æ€ç®¡ç†\n * \n * æ™ºèƒ½åˆçº¦é›†æˆ:\n * - æŠ½å¥–åˆçº¦: å¤„ç†æŠ½å¥–é€»è¾‘ã€å¥–æ± ç®¡ç†ã€éšæœºæ•°ç”Ÿæˆ\n * - XWAWAä»£å¸åˆçº¦: å¤„ç†ä»£å¸æ”¯ä»˜å’Œä½™é¢æŸ¥è¯¢\n * - äº‹ä»¶ç›‘å¬: æŠ½å¥–ç»“æœã€ä»£å¸è½¬è´¦ç­‰åŒºå—é“¾äº‹ä»¶\n * \n * åç«¯APIéœ€æ±‚:\n * - POST /api/lottery/draw - è®°å½•æŠ½å¥–å†å²\n * - GET /api/lottery/history - è·å–ç”¨æˆ·æŠ½å¥–è®°å½•\n * - GET /api/lottery/stats - è·å–æŠ½å¥–ç»Ÿè®¡æ•°æ®\n * \n * å®‰å…¨è€ƒè™‘:\n * - å®¢æˆ·ç«¯éšæœºæ•°ä»…ç”¨äºåŠ¨ç”»ï¼Œå®é™…ç»“æœç”±æ™ºèƒ½åˆçº¦ç”Ÿæˆ\n * - äº¤æ˜“ç­¾åéªŒè¯\n * - é˜²æ­¢é‡å¤æäº¤\n */\n\n/**\n * å…¨å±€å˜é‡å®šä¹‰\n * ç”¨äºç®¡ç†Web3è¿æ¥ã€åˆçº¦å®ä¾‹å’ŒæŠ½å¥–çŠ¶æ€\n */\nlet web3;                    // Web3å®ä¾‹\nlet lotteryContract;         // æŠ½å¥–æ™ºèƒ½åˆçº¦å®ä¾‹\nlet userAccount;             // ç”¨æˆ·é’±åŒ…åœ°å€\nlet isConnected = false;     // é’±åŒ…è¿æ¥çŠ¶æ€\nlet drawTimes = 1;           // æŠ½å¥–æ¬¡æ•°\nlet drawCost = 10000;        // æ¯æ¬¡æŠ½å¥–èŠ±è´¹çš„XWAWAä»£å¸æ•°é‡ (ä»åˆçº¦è·å–)\nlet isSpinning = false;      // è½¬ç›˜æ—‹è½¬çŠ¶æ€é”\n\n/**\n * å¥–é¡¹é…ç½®\n * å®šä¹‰æŠ½å¥–å¥–é¡¹çš„åŸºæœ¬ä¿¡æ¯å’Œæ¦‚ç‡åˆ†å¸ƒ\n * æ³¨æ„: å®é™…æ¦‚ç‡ç”±æ™ºèƒ½åˆçº¦æ§åˆ¶ï¼Œæ­¤å¤„ä»…ç”¨äºå‰ç«¯å±•ç¤º\n */\nconst prizes = [\n    { id: 1, name: \"ä¸€ç­‰å¥–\", probability: 0.01, color: \"#FF6B6B\", className: \"first-prize\" },\n    { id: 2, name: \"äºŒç­‰å¥–\", probability: 0.05, color: \"#4ECDC4\", className: \"second-prize\" },\n    { id: 3, name: \"ä¸‰ç­‰å¥–\", probability: 0.10, color: \"#FFD166\", className: \"third-prize\" },\n    { id: 4, name: \"å¥–æ± åˆ†çº¢\", probability: 0.15, color: \"#06D6A0\", className: \"pool-prize\" },\n    { id: 5, name: \"åŒå€æŠ½å¥–\", probability: 0.20, color: \"#118AB2\", className: \"double\" },\n    { id: 6, name: \"è°¢è°¢å‚ä¸\", probability: 0.49, color: \"#073B4C\", className: \"nothing\" }\n];\n\n/**\n * æ™ºèƒ½åˆçº¦ABIé…ç½®\n * \n * é‡è¦è¯´æ˜:\n * 1. æ­¤ABIéœ€è¦ä¸éƒ¨ç½²çš„æ™ºèƒ½åˆçº¦å®Œå…¨åŒ¹é…\n * 2. éƒ¨ç½²åˆçº¦åï¼Œéœ€è¦ä»ç¼–è¯‘è¾“å‡ºä¸­è·å–å®Œæ•´ABI\n * 3. å»ºè®®å°†ABIå­˜å‚¨åœ¨å•ç‹¬çš„JSONæ–‡ä»¶ä¸­ï¼Œé€šè¿‡fetchåŠ¨æ€åŠ è½½\n * \n * ä¸»è¦åˆçº¦æ–¹æ³•:\n * - draw(): æ‰§è¡ŒæŠ½å¥–ï¼Œè¿”å›å¥–é¡¹ID\n * - drawCost(): è·å–æŠ½å¥–è´¹ç”¨\n * - getBalance(): è·å–ç”¨æˆ·ä»£å¸ä½™é¢\n * - getPrizePool(): è·å–å¥–æ± é‡‘é¢\n * - getUserDrawHistory(): è·å–ç”¨æˆ·æŠ½å¥–å†å²\n * \n * äº‹ä»¶ç›‘å¬:\n * - DrawResult: æŠ½å¥–ç»“æœäº‹ä»¶\n * - PrizeAwarded: å¥–å“å‘æ”¾äº‹ä»¶\n * - PoolUpdated: å¥–æ± æ›´æ–°äº‹ä»¶\n */\nconst lotteryABI = [\n    // TODO: ä»å®é™…éƒ¨ç½²çš„åˆçº¦ä¸­è·å–å®Œæ•´ABI\n    // ä»¥ä¸‹æ˜¯ç¤ºä¾‹ç»“æ„ï¼Œå®é™…ä½¿ç”¨æ—¶éœ€è¦æ›¿æ¢\n    {\n        \"inputs\": [],\n        \"name\": \"draw\",\n        \"outputs\": [\n            {\n                \"internalType\": \"uint256\",\n                \"name\": \"\",\n                \"type\": \"uint256\"\n            }\n        ],\n        \"stateMutability\": \"nonpayable\",\n        \"type\": \"function\"\n    },\n    {\n        \"inputs\": [],\n        \"name\": \"drawCost\",\n        \"outputs\": [\n            {\n                \"internalType\": \"uint256\",\n                \"name\": \"\",\n                \"type\": \"uint256\"\n            }\n        ],\n        \"stateMutability\": \"view\",\n        \"type\": \"function\"\n    }\n    // æ›´å¤šæ–¹æ³•å’Œäº‹ä»¶å®šä¹‰...\n];\n\n/**\n * æ™ºèƒ½åˆçº¦åœ°å€é…ç½®\n * \n * éƒ¨ç½²è¯´æ˜:\n * 1. åœ¨æµ‹è¯•ç½‘éƒ¨ç½²åˆçº¦åï¼Œæ›´æ–°æ­¤åœ°å€\n * 2. ä¸»ç½‘éƒ¨ç½²å‰ï¼Œç¡®ä¿åˆçº¦ç»è¿‡å……åˆ†æµ‹è¯•å’Œå®¡è®¡\n * 3. å»ºè®®ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†ä¸åŒç½‘ç»œçš„åˆçº¦åœ°å€\n * \n * ç½‘ç»œé…ç½®:\n * - æµ‹è¯•ç½‘: Goerli, Sepoliaç­‰\n * - ä¸»ç½‘: Ethereum Mainnet\n * - ä¾§é“¾: Polygon, BSCç­‰\n */\nconst lotteryContractAddress = \"0x1234567890123456789012345678901234567890\"; // TODO: æ›¿æ¢ä¸ºå®é™…éƒ¨ç½²åœ°å€\n\n/**\n * XWAWAä»£å¸åˆçº¦åœ°å€\n * ç”¨äºä»£å¸ä½™é¢æŸ¥è¯¢å’Œæˆæƒæ“ä½œ\n */\nconst xwawaTokenAddress = \"0x0987654321098765432109876543210987654321\"; // TODO: æ›¿æ¢ä¸ºå®é™…ä»£å¸åœ°å€\n\n/**\n * é¡µé¢åˆå§‹åŒ–\n * åœ¨DOMåŠ è½½å®Œæˆåæ‰§è¡Œæ‰€æœ‰åˆå§‹åŒ–æ“ä½œ\n */\ndocument.addEventListener('DOMContentLoaded', function() {\n    // åˆå§‹åŒ–ç”¨æˆ·ç•Œé¢çŠ¶æ€\n    updateUI();\n    \n    // ç»‘å®šç”¨æˆ·äº¤äº’äº‹ä»¶\n    document.getElementById('connect-wallet-btn').addEventListener('click', connectWallet);\n    document.getElementById('draw-button').addEventListener('click', startDraw);\n    document.getElementById('draw-times-minus').addEventListener('click', () => updateDrawTimes(-1));\n    document.getElementById('draw-times-plus').addEventListener('click', () => updateDrawTimes(1));\n    document.getElementById('draw-times-input').addEventListener('change', validateDrawTimes);\n    \n    // ç»‘å®šå¼¹çª—å…³é—­äº‹ä»¶\n    document.querySelectorAll('.close-modal, .close-result-btn').forEach(element => {\n        element.addEventListener('click', closeResultModal);\n    });\n    \n    // åˆå§‹åŒ–å¤šè¯­è¨€åŠŸèƒ½\n    initLanguageSwitch();\n    \n    // æ£€æŸ¥æ˜¯å¦å·²è¿æ¥é’±åŒ… (é¡µé¢åˆ·æ–°åæ¢å¤çŠ¶æ€)\n    checkWalletConnection();\n});\n\n/**\n * åˆå§‹åŒ–è¯­è¨€åˆ‡æ¢åŠŸèƒ½\n * ç»‘å®šè¯­è¨€åˆ‡æ¢å¼€å…³çš„äº‹ä»¶ç›‘å¬å™¨\n */\nfunction initLanguageSwitch() {\n    const languageSwitch = document.getElementById('language-switch');\n    if (languageSwitch) {\n        languageSwitch.addEventListener('change', function() {\n            const lang = this.checked ? 'en' : 'zh';\n            switchLanguage(lang);\n            // ä¿å­˜ç”¨æˆ·è¯­è¨€åå¥½åˆ°æœ¬åœ°å­˜å‚¨\n            localStorage.setItem('preferred-language', lang);\n        });\n        \n        // æ¢å¤ç”¨æˆ·è¯­è¨€åå¥½\n        const savedLang = localStorage.getItem('preferred-language') || 'zh';\n        languageSwitch.checked = savedLang === 'en';\n        switchLanguage(savedLang);\n    }\n}\n\n/**\n * è¯­è¨€åˆ‡æ¢åŠŸèƒ½\n * æ ¹æ®é€‰æ‹©çš„è¯­è¨€æ›´æ–°é¡µé¢æ–‡æœ¬å†…å®¹\n * @param {string} lang - è¯­è¨€ä»£ç  ('zh' æˆ– 'en')\n */\nfunction switchLanguage(lang) {\n    const elements = document.querySelectorAll('[data-lang-zh], [data-lang-en]');\n    \n    elements.forEach(element => {\n        if (lang === 'zh') {\n            if (element.hasAttribute('data-lang-zh')) {\n                element.textContent = element.getAttribute('data-lang-zh');\n            }\n        } else {\n            if (element.hasAttribute('data-lang-en')) {\n                element.textContent = element.getAttribute('data-lang-en');\n            }\n        }\n    });\n}\n\n/**\n * æ£€æŸ¥é’±åŒ…è¿æ¥çŠ¶æ€\n * é¡µé¢åŠ è½½æ—¶æ£€æŸ¥æ˜¯å¦å·²è¿æ¥é’±åŒ…ï¼Œæ¢å¤è¿æ¥çŠ¶æ€\n */\nasync function checkWalletConnection() {\n    if (window.ethereum) {\n        try {\n            const accounts = await window.ethereum.request({ method: 'eth_accounts' });\n            if (accounts.length > 0) {\n                userAccount = accounts[0];\n                web3 = new Web3(window.ethereum);\n                lotteryContract = new web3.eth.Contract(lotteryABI, lotteryContractAddress);\n                isConnected = true;\n                updateUI();\n                \n                // è·å–æœ€æ–°çš„æŠ½å¥–æˆæœ¬\n                await updateDrawCostFromContract();\n            }\n        } catch (error) {\n            console.error(\"æ£€æŸ¥é’±åŒ…è¿æ¥å¤±è´¥:\", error);\n        }\n    }\n}\n\n/**\n * è¿æ¥é’±åŒ…åŠŸèƒ½\n * æ£€æµ‹å¹¶è¿æ¥ç”¨æˆ·çš„Web3é’±åŒ… (ä¸»è¦æ”¯æŒMetaMask)\n * \n * åŠŸèƒ½æµç¨‹:\n * 1. æ£€æµ‹é’±åŒ…æ˜¯å¦å®‰è£…\n * 2. è¯·æ±‚ç”¨æˆ·æˆæƒè¿æ¥\n * 3. åˆå§‹åŒ–Web3å®ä¾‹å’Œæ™ºèƒ½åˆçº¦\n * 4. è·å–åˆçº¦å‚æ•° (æŠ½å¥–æˆæœ¬ç­‰)\n * 5. æ›´æ–°UIçŠ¶æ€\n * \n * é”™è¯¯å¤„ç†:\n * - é’±åŒ…æœªå®‰è£…: æç¤ºç”¨æˆ·å®‰è£…MetaMask\n * - ç”¨æˆ·æ‹’ç»è¿æ¥: æ˜¾ç¤ºè¿æ¥å¤±è´¥ä¿¡æ¯\n * - ç½‘ç»œé”™è¯¯: æç¤ºæ£€æŸ¥ç½‘ç»œè¿æ¥\n * - åˆçº¦è°ƒç”¨å¤±è´¥: ä½¿ç”¨é»˜è®¤å‚æ•°\n */\nasync function connectWallet() {\n    try {\n        // æ£€æŸ¥æ˜¯å¦å®‰è£…äº†Web3é’±åŒ… (MetaMaskç­‰)\n        if (window.ethereum) {\n            console.log(\"Web3é’±åŒ…å·²æ£€æµ‹åˆ°\");\n            \n            // è¯·æ±‚ç”¨æˆ·æˆæƒè¿æ¥é’±åŒ…\n            const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });\n            userAccount = accounts[0];\n            \n            // åˆ›å»ºWeb3å®ä¾‹\n            web3 = new Web3(window.ethereum);\n            \n            // åˆå§‹åŒ–æŠ½å¥–æ™ºèƒ½åˆçº¦å®ä¾‹\n            lotteryContract = new web3.eth.Contract(lotteryABI, lotteryContractAddress);\n            \n            // ä»æ™ºèƒ½åˆçº¦è·å–æœ€æ–°çš„æŠ½å¥–æˆæœ¬\n            await updateDrawCostFromContract();\n            \n            // ç›‘å¬è´¦æˆ·å˜åŒ–äº‹ä»¶\n            window.ethereum.on('accountsChanged', handleAccountsChanged);\n            \n            // ç›‘å¬ç½‘ç»œå˜åŒ–äº‹ä»¶\n            window.ethereum.on('chainChanged', handleChainChanged);\n            \n            // æ›´æ–°è¿æ¥çŠ¶æ€\n            isConnected = true;\n            \n            // æ›´æ–°ç”¨æˆ·ç•Œé¢\n            updateUI();\n            \n            console.log(\"é’±åŒ…è¿æ¥æˆåŠŸ:\", userAccount);\n            \n        } else {\n            // é’±åŒ…æœªå®‰è£…çš„å¤„ç†\n            alert(\"è¯·å®‰è£…MetaMaské’±åŒ…ä»¥ä½¿ç”¨æŠ½å¥–åŠŸèƒ½ï¼\");\n            window.open(\"https://metamask.io/download/\", \"_blank\");\n        }\n    } catch (error) {\n        console.error(\"è¿æ¥é’±åŒ…å¤±è´¥:\", error);\n        \n        // æ ¹æ®é”™è¯¯ç±»å‹æ˜¾ç¤ºä¸åŒçš„æç¤ºä¿¡æ¯\n        if (error.code === 4001) {\n            alert(\"ç”¨æˆ·æ‹’ç»äº†é’±åŒ…è¿æ¥è¯·æ±‚\");\n        } else if (error.code === -32002) {\n            alert(\"é’±åŒ…è¿æ¥è¯·æ±‚å·²åœ¨å¤„ç†ä¸­ï¼Œè¯·æ£€æŸ¥MetaMask\");\n        } else {\n            alert(\"è¿æ¥é’±åŒ…æ—¶å‘ç”Ÿé”™è¯¯ï¼Œè¯·é‡è¯•\");\n        }\n        \n        // é‡ç½®è¿æ¥çŠ¶æ€\n        isConnected = false;\n        updateUI();\n    }\n}\n\n/**\n * ä»æ™ºèƒ½åˆçº¦æ›´æ–°æŠ½å¥–æˆæœ¬\n * è·å–åˆçº¦ä¸­è®¾ç½®çš„æœ€æ–°æŠ½å¥–è´¹ç”¨\n */\nasync function updateDrawCostFromContract() {\n    try {\n        const contractDrawCost = await lotteryContract.methods.drawCost().call();\n        drawCost = web3.utils.fromWei(contractDrawCost, 'ether');\n        console.log(\"åˆçº¦æŠ½å¥–æˆæœ¬:\", drawCost);\n        \n        // æ›´æ–°UIæ˜¾ç¤º\n        const costElement = document.getElementById('cost-amount');\n        if (costElement) {\n            costElement.textContent = drawCost;\n        }\n        \n        // æ›´æ–°æ€»è´¹ç”¨æ˜¾ç¤º\n        updateTotalCost();\n        \n    } catch (error) {\n        console.error(\"è·å–æŠ½å¥–æˆæœ¬å¤±è´¥:\", error);\n        // ä½¿ç”¨é»˜è®¤å€¼ï¼Œä¸å½±å“ç”¨æˆ·ä½“éªŒ\n        const costElement = document.getElementById('cost-amount');\n        if (costElement) {\n            costElement.textContent = drawCost;\n        }\n    }\n}\n\n/**\n * å¤„ç†è´¦æˆ·å˜åŒ–äº‹ä»¶\n * å½“ç”¨æˆ·åœ¨MetaMaskä¸­åˆ‡æ¢è´¦æˆ·æ—¶è§¦å‘\n */\nfunction handleAccountsChanged(accounts) {\n    if (accounts.length === 0) {\n        // ç”¨æˆ·æ–­å¼€äº†é’±åŒ…è¿æ¥\n        isConnected = false;\n        userAccount = null;\n        console.log(\"é’±åŒ…å·²æ–­å¼€è¿æ¥\");\n    } else {\n        // ç”¨æˆ·åˆ‡æ¢äº†è´¦æˆ·\n        userAccount = accounts[0];\n        console.log(\"è´¦æˆ·å·²åˆ‡æ¢:\", userAccount);\n    }\n    updateUI();\n}\n\n/**\n * å¤„ç†ç½‘ç»œå˜åŒ–äº‹ä»¶\n * å½“ç”¨æˆ·åœ¨MetaMaskä¸­åˆ‡æ¢ç½‘ç»œæ—¶è§¦å‘\n */\nfunction handleChainChanged(chainId) {\n    console.log(\"ç½‘ç»œå·²åˆ‡æ¢:\", chainId);\n    // é‡æ–°åŠ è½½é¡µé¢ä»¥ç¡®ä¿åº”ç”¨çŠ¶æ€æ­£ç¡®\n    window.location.reload();\n}\n\n/**\n * æ›´æ–°æŠ½å¥–æ¬¡æ•°\n * é€šè¿‡åŠ å‡æŒ‰é’®è°ƒæ•´æŠ½å¥–æ¬¡æ•°\n * @param {number} change - å˜åŒ–é‡ (+1 æˆ– -1)\n */\nfunction updateDrawTimes(change) {\n    const input = document.getElementById('draw-times-input');\n    let newValue = parseInt(input.value) + change;\n    \n    // ç¡®ä¿æ¬¡æ•°åœ¨æœ‰æ•ˆèŒƒå›´å†… (1-100æ¬¡)\n    if (newValue < 1) newValue = 1;\n    if (newValue > 100) newValue = 100;\n    \n    input.value = newValue;\n    drawTimes = newValue;\n    updateTotalCost();\n}\n\n/**\n * éªŒè¯æŠ½å¥–æ¬¡æ•°è¾“å…¥\n * å½“ç”¨æˆ·ç›´æ¥åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æ•°å­—æ—¶è¿›è¡ŒéªŒè¯\n */\nfunction validateDrawTimes() {\n    const input = document.getElementById('draw-times-input');\n    let value = parseInt(input.value);\n    \n    // ç¡®ä¿è¾“å…¥æ˜¯æœ‰æ•ˆæ•°å­—ä¸”åœ¨å…è®¸èŒƒå›´å†…\n    if (isNaN(value) || value < 1) {\n        value = 1;\n    } else if (value > 100) {\n        value = 100;\n    }\n    \n    input.value = value;\n    drawTimes = value;\n    updateTotalCost();\n}\n\n/**\n * æ›´æ–°æ€»èŠ±è´¹æ˜¾ç¤º\n * æ ¹æ®æŠ½å¥–æ¬¡æ•°å’Œå•æ¬¡è´¹ç”¨è®¡ç®—æ€»è´¹ç”¨\n */\nfunction updateTotalCost() {\n    const totalCost = drawTimes * drawCost;\n    const totalCostElement = document.getElementById('total-cost-amount');\n    if (totalCostElement) {\n        totalCostElement.textContent = totalCost;\n    }\n}\n\n/**\n * å¼€å§‹æŠ½å¥–åŠŸèƒ½\n * æ‰§è¡ŒæŠ½å¥–æµç¨‹ï¼ŒåŒ…æ‹¬æ™ºèƒ½åˆçº¦äº¤äº’å’Œç»“æœå¤„ç†\n * \n * æŠ½å¥–æµç¨‹:\n * 1. éªŒè¯é’±åŒ…è¿æ¥çŠ¶æ€\n * 2. æ£€æŸ¥ç”¨æˆ·ä»£å¸ä½™é¢\n * 3. è°ƒç”¨æ™ºèƒ½åˆçº¦æ‰§è¡ŒæŠ½å¥–\n * 4. å¤„ç†æŠ½å¥–ç»“æœå’ŒåŠ¨ç”»\n * 5. æ›´æ–°ç”¨æˆ·ç•Œé¢å’Œå†å²è®°å½•\n * \n * æ™ºèƒ½åˆçº¦äº¤äº’:\n * - æ£€æŸ¥ç”¨æˆ·XWAWAä»£å¸ä½™é¢\n * - æˆæƒåˆçº¦æ‰£é™¤ä»£å¸\n * - è°ƒç”¨æŠ½å¥–åˆçº¦æ–¹æ³•\n * - ç›‘å¬æŠ½å¥–ç»“æœäº‹ä»¶\n * \n * åç«¯APIè°ƒç”¨:\n * - POST /api/lottery/draw - è®°å½•æŠ½å¥–å†å²\n * - PUT /api/users/balance - æ›´æ–°ç”¨æˆ·ä½™é¢\n */\nasync function startDraw() {\n    // æ£€æŸ¥é’±åŒ…è¿æ¥çŠ¶æ€\n    if (!isConnected) {\n        alert('è¯·å…ˆè¿æ¥é’±åŒ…');\n        return;\n    }\n    \n    // é˜²æ­¢é‡å¤æŠ½å¥–\n    if (isSpinning) {\n        return;\n    }\n    \n    // è®¾ç½®æŠ½å¥–çŠ¶æ€ï¼Œç¦ç”¨æŠ½å¥–æŒ‰é’®\n    isSpinning = true;\n    const drawButton = document.getElementById('draw-button');\n    if (drawButton) {\n        drawButton.disabled = true;\n        drawButton.textContent = 'æŠ½å¥–ä¸­...';\n    }\n    \n    try {\n        // æ£€æŸ¥ç”¨æˆ·ä»£å¸ä½™é¢\n        const totalCost = drawTimes * drawCost;\n        const userBalance = await getUserTokenBalance();\n        \n        if (userBalance < totalCost) {\n            alert(`ä½™é¢ä¸è¶³ï¼éœ€è¦ ${totalCost} XWAWAï¼Œå½“å‰ä½™é¢ ${userBalance} XWAWA`);\n            return;\n        }\n        \n        // è°ƒç”¨æ™ºèƒ½åˆçº¦æ‰§è¡ŒæŠ½å¥–\n        const results = await drawFromContract();\n        \n        // æ’­æ”¾æŠ½å¥–éŸ³æ•ˆ\n        playSpinSound();\n        \n        // æ‰§è¡Œè½¬ç›˜åŠ¨ç”» (ä½¿ç”¨ç¬¬ä¸€ä¸ªç»“æœ)\n        if (results.length > 0) {\n            spinWheel(results[0].id);\n        }\n        \n        // ç­‰å¾…åŠ¨ç”»å®Œæˆåæ˜¾ç¤ºç»“æœ\n        setTimeout(() => {\n            // æ·»åŠ è·å¥–ç‰¹æ•ˆ\n            if (results.length > 0 && results[0].id <= 4) {\n                addWinEffect(results[0].id);\n            }\n            \n            // æ˜¾ç¤ºæŠ½å¥–ç»“æœ\n            showResultModal(results);\n            \n            // æ·»åŠ åˆ°å†å²è®°å½•\n            addResultsToList(results);\n            \n            // é‡ç½®æŠ½å¥–çŠ¶æ€\n            resetDrawState();\n            \n        }, 3000); // ç­‰å¾…è½¬ç›˜åŠ¨ç”»å®Œæˆ\n        \n    } catch (error) {\n        console.error(\"æŠ½å¥–å¤±è´¥:\", error);\n        alert('æŠ½å¥–å¤±è´¥ï¼Œè¯·é‡è¯•');\n        resetDrawState();\n    }\n}\n\n/**\n * é‡ç½®æŠ½å¥–çŠ¶æ€\n * æ¢å¤æŠ½å¥–æŒ‰é’®å’Œç›¸å…³UIçŠ¶æ€\n */\nfunction resetDrawState() {\n    isSpinning = false;\n    const drawButton = document.getElementById('draw-button');\n    if (drawButton) {\n        drawButton.disabled = false;\n        drawButton.textContent = 'å¼€å§‹æŠ½å¥–';\n    }\n}\n\n/**\n * è·å–ç”¨æˆ·ä»£å¸ä½™é¢\n * ä»XWAWAä»£å¸åˆçº¦æŸ¥è¯¢ç”¨æˆ·ä½™é¢\n * @returns {Promise<number>} ç”¨æˆ·ä»£å¸ä½™é¢\n */\nasync function getUserTokenBalance() {\n    try {\n        const xwawaContract = await getXwawaContract();\n        const balance = await xwawaContract.methods.balanceOf(userAccount).call();\n        return parseFloat(web3.utils.fromWei(balance, 'ether'));\n    } catch (error) {\n        console.error(\"è·å–ç”¨æˆ·ä½™é¢å¤±è´¥:\", error);\n        return 0;\n    }\n}\n\n/**\n * æ¨¡æ‹ŸæŠ½å¥–ç»“æœç”Ÿæˆ (ä»…ç”¨äºå¼€å‘æµ‹è¯•)\n * å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç»“æœåº”å®Œå…¨ç”±æ™ºèƒ½åˆçº¦ç”Ÿæˆ\n * @returns {Array} æŠ½å¥–ç»“æœæ•°ç»„\n */\nfunction generateMockResults() {\n    const results = [];\n    for (let i = 0; i < drawTimes; i++) {\n        // éšæœºé€‰æ‹©ä¸€ä¸ªå¥–é¡¹ (ä»…ç”¨äºå‰ç«¯å±•ç¤º)\n        const result = getRandomPrize();\n        results.push(result);\n            \n        // å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡æŠ½å¥–ï¼Œæ—‹è½¬è½¬ç›˜\n        if (i === 0) {\n            spinWheel(result.id);\n        }\n    }\n        \n    // æ·»åŠ æŠ½å¥–ç»“æœåˆ°ç»“æœåˆ—è¡¨\n    addResultsToList(results);\n        \n    // å¦‚æœåªæŠ½å¥–ä¸€æ¬¡ï¼Œæ˜¾ç¤ºç»“æœå¼¹çª—\n    if (drawTimes === 1) {\n        setTimeout(() => {\n            showResultModal(results[0]);\n        }, 5500); // ç­‰å¾…è½¬ç›˜åœæ­¢åæ˜¾ç¤º\n    }\n        \n    console.log(\"æŠ½å¥–å®Œæˆï¼Œç»“æœ:\", results);\n    try {\n        console.error(\"æŠ½å¥–å¤±è´¥:\", error);\n        alert('æŠ½å¥–å¤±è´¥ï¼Œè¯·é‡è¯•');\n        isSpinning = false;\n        document.getElementById('draw-button').disabled = false;\n    }\n    catch (error) {\n        console.error(\"æŠ½å¥–å¤±è´¥:\", error);\n        alert('æŠ½å¥–å¤±è´¥ï¼Œè¯·é‡è¯•');\n        isSpinning = false;\n        document.getElementById('draw-button').disabled = false;\n    }\n\n    // è·å–éšæœºå¥–é¡¹\n    function getRandomPrize() {\n        const random = Math.random();\n        let cumulativeProbability = 0;\n    \n        for (const prize of prizes) {\n            cumulativeProbability += prize.probability;\n            if (random <= cumulativeProbability) {\n                return prize;\n            }\n        }\n    \n        // é»˜è®¤è¿”å›æœ€åä¸€ä¸ªå¥–é¡¹\n        return prizes[prizes.length - 1];\n    }\n\n    // æ—‹è½¬è½¬ç›˜ - Web3é£æ ¼ä¼˜åŒ–ç‰ˆæœ¬\n    function spinWheel(prizeId) {\n        const wheel = document.querySelector('.wheel-inner');\n        const wheelContainer = document.querySelector('.lottery-wheel-container');\n        const pointer = document.querySelector('.wheel-pointer');\n    \n        // æ·»åŠ æ—‹è½¬å¼€å§‹çš„è§†è§‰æ•ˆæœ\n        wheelContainer.classList.add('spinning');\n        pointer.classList.add('pointer-active');\n    \n        // è®¡ç®—æ—‹è½¬è§’åº¦\n        // æ¯ä¸ªå¥–é¡¹å 60åº¦ï¼Œè®¡ç®—ç›®æ ‡å¥–é¡¹çš„ä¸­å¿ƒè§’åº¦\n        const targetAngle = (prizeId - 1) * 60 + 30;\n    \n        // æ·»åŠ éšæœºçš„é¢å¤–æ—‹è½¬åœˆæ•° (6-8åœˆ)\n        const extraRotations = (6 + Math.random() * 2) * 360;\n    \n        // æœ€ç»ˆæ—‹è½¬è§’åº¦ = é¢å¤–åœˆæ•° + (360 - ç›®æ ‡è§’åº¦)\n        const finalRotation = extraRotations + (360 - targetAngle);\n    \n        // åº”ç”¨é«˜çº§æ—‹è½¬åŠ¨ç”»\n        wheel.style.transition = 'transform 4s cubic-bezier(0.25, 0.46, 0.45, 0.94)';\n        wheel.style.transform = `rotate(${finalRotation}deg)`;\n    \n        // æ·»åŠ éŸ³æ•ˆå’Œéœ‡åŠ¨æ•ˆæœ (å¦‚æœæ”¯æŒ)\n        playSpinSound();\n        addVibration();\n    \n        // åŠ¨ç”»è¿‡ç¨‹ä¸­çš„ä¸­é—´æ•ˆæœ\n        setTimeout(() => {\n            // ä¸­é€”æ·»åŠ ä¸€äº›è§†è§‰åé¦ˆ\n            wheelContainer.classList.add('mid-spin');\n        }, 2000);\n    \n        // åŠ¨ç”»ç»“æŸåçš„å¤„ç†\n        setTimeout(() => {\n            isSpinning = false;\n            wheelContainer.classList.remove('spinning', 'mid-spin');\n            pointer.classList.remove('pointer-active');\n            wheelContainer.classList.add('spin-complete');\n        \n            // æ·»åŠ è·å¥–æ•ˆæœ\n            addWinEffect(prizeId);\n        \n            document.getElementById('draw-button').disabled = false;\n        \n            // æ¸…é™¤å®ŒæˆçŠ¶æ€\n            setTimeout(() => {\n                wheelContainer.classList.remove('spin-complete');\n            }, 1000);\n        }, 4000);\n    }\n\n    // æ’­æ”¾æ—‹è½¬éŸ³æ•ˆ\n    function playSpinSound() {\n        try {\n            // åˆ›å»ºéŸ³é¢‘ä¸Šä¸‹æ–‡æ¥æ’­æ”¾ç®€å•çš„éŸ³æ•ˆ\n            const audioContext = new (window.AudioContext || window.webkitAudioContext)();\n            const oscillator = audioContext.createOscillator();\n            const gainNode = audioContext.createGain();\n        \n            oscillator.connect(gainNode);\n            gainNode.connect(audioContext.destination);\n        \n            oscillator.frequency.setValueAtTime(200, audioContext.currentTime);\n            oscillator.frequency.exponentialRampToValueAtTime(100, audioContext.currentTime + 0.1);\n        \n            gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);\n            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);\n        \n            oscillator.start(audioContext.currentTime);\n            oscillator.stop(audioContext.currentTime + 0.1);\n        } catch (e) {\n            // å¦‚æœéŸ³é¢‘APIä¸æ”¯æŒï¼Œé™é»˜å¤±è´¥\n            console.log('Audio not supported');\n        }\n    }\n\n    // æ·»åŠ éœ‡åŠ¨æ•ˆæœ\n    function addVibration() {\n        if ('vibrate' in navigator) {\n            navigator.vibrate([100, 50, 100]);\n        }\n    }\n\n    // æ·»åŠ è·å¥–æ•ˆæœ\n    function addWinEffect(prizeId) {\n        const wheelContainer = document.querySelector('.lottery-wheel-container');\n    \n        // æ ¹æ®å¥–é¡¹ç­‰çº§æ·»åŠ ä¸åŒçš„æ•ˆæœ\n        if (prizeId <= 3) {\n            // é«˜çº§å¥–é¡¹ï¼šæ·»åŠ é—ªå…‰æ•ˆæœ\n            wheelContainer.classList.add('major-win');\n            createFireworks();\n            setTimeout(() => {\n                wheelContainer.classList.remove('major-win');\n            }, 3000);\n        } else if (prizeId <= 5) {\n            // ä¸­çº§å¥–é¡¹ï¼šæ·»åŠ å‘å…‰æ•ˆæœ\n            wheelContainer.classList.add('minor-win');\n            setTimeout(() => {\n                wheelContainer.classList.remove('minor-win');\n            }, 2000);\n        }\n    }\n\n    // åˆ›å»ºçƒŸèŠ±æ•ˆæœ\n    function createFireworks() {\n        const container = document.querySelector('.lottery-wheel-container');\n    \n        for (let i = 0; i < 20; i++) {\n            setTimeout(() => {\n                const particle = document.createElement('div');\n                particle.className = 'firework-particle';\n                particle.style.left = Math.random() * 100 + '%';\n                particle.style.top = Math.random() * 100 + '%';\n                container.appendChild(particle);\n            \n                setTimeout(() => {\n                    particle.remove();\n                }, 1000);\n            }, i * 100);\n        }\n    }\n\n    // æ·»åŠ ç»“æœåˆ°åˆ—è¡¨\n    function addResultsToList(results) {\n        const resultsList = document.querySelector('.results-list');\n        const noResults = document.querySelector('.no-results');\n    \n        if (noResults) {\n            noResults.style.display = 'none';\n        }\n    \n        results.forEach(result => {\n            const resultItem = document.createElement('div');\n            resultItem.className = `result-item ${result.className}`;\n        \n            resultItem.innerHTML = `\n            <span class=\"result-name\">${result.name}</span>\n            <span class=\"result-value\">${new Date().toLocaleTimeString()}</span>\n        `;\n        \n            resultsList.prepend(resultItem);\n        });\n    }\n\n    // æ˜¾ç¤ºç»“æœå¼¹çª—\n    function showResultModal(result) {\n        const modal = document.getElementById('result-modal');\n        const resultTitle = document.getElementById('result-title');\n        const resultMessage = document.getElementById('result-message');\n        const resultIcon = document.getElementById('result-icon');\n    \n        // è®¾ç½®ç»“æœä¿¡æ¯\n        resultTitle.textContent = `æ­å–œè·å¾—: ${result.name}`;\n        resultMessage.textContent = getResultMessage(result.id);\n        resultIcon.textContent = getResultIcon(result.id);\n        resultIcon.style.color = result.color;\n    \n        // æ˜¾ç¤ºå¼¹çª—\n        modal.style.display = 'block';\n    }\n\n    // å…³é—­ç»“æœå¼¹çª—\n    function closeResultModal() {\n        const modal = document.getElementById('result-modal');\n        modal.style.display = 'none';\n    }\n\n    // è·å–ç»“æœæ¶ˆæ¯\n    function getResultMessage(prizeId) {\n        switch (prizeId) {\n            case 1:\n                return \"æ­å–œæ‚¨è·å¾—ä¸€ç­‰å¥–ï¼å¥–åŠ±å·²å‘æ”¾åˆ°æ‚¨çš„è´¦æˆ·ã€‚\";\n            case 2:\n                return \"æ­å–œæ‚¨è·å¾—äºŒç­‰å¥–ï¼å¥–åŠ±å·²å‘æ”¾åˆ°æ‚¨çš„è´¦æˆ·ã€‚\";\n            case 3:\n                return \"æ­å–œæ‚¨è·å¾—ä¸‰ç­‰å¥–ï¼å¥–åŠ±å·²å‘æ”¾åˆ°æ‚¨çš„è´¦æˆ·ã€‚\";\n            case 4:\n                return \"æ‚¨è·å¾—äº†å¥–æ± åˆ†çº¢ï¼å¥–åŠ±å·²å‘æ”¾åˆ°æ‚¨çš„è´¦æˆ·ã€‚\";\n            case 5:\n                return \"æ‚¨è·å¾—äº†åŒå€æŠ½å¥–æœºä¼šï¼ä¸‹æ¬¡æŠ½å¥–å°†è·å¾—åŒå€å¥–åŠ±ã€‚\";\n            case 6:\n                return \"è°¢è°¢å‚ä¸ï¼Œä¸‹æ¬¡å†æ¥å†å‰ï¼\";\n            default:\n                return \"æŠ½å¥–ç»“æœæœªçŸ¥ï¼Œè¯·è”ç³»å®¢æœã€‚\";\n        }\n    }\n\n    // è·å–ç»“æœå›¾æ ‡\n    function getResultIcon(prizeId) {\n        switch (prizeId) {\n            case 1:\n                return \"ğŸ†\";\n            case 2:\n                return \"ğŸ¥ˆ\";\n            case 3:\n                return \"ğŸ¥‰\";\n            case 4:\n                return \"ğŸ’°\";\n            case 5:\n                return \"ğŸ¯\";\n            case 6:\n                return \"ğŸ˜Š\";\n            default:\n                return \"â“\";\n        }\n    }\n\n    // æ›´æ–°UI\n    function updateUI() {\n        const walletStatus = document.getElementById('wallet-status');\n        const connectButton = document.getElementById('connect-wallet-btn');\n        const drawButton = document.getElementById('draw-button');\n    \n        if (isConnected) {\n            walletStatus.textContent = `å·²è¿æ¥: ${shortenAddress(userAccount)}`;\n            walletStatus.className = 'connected';\n            connectButton.textContent = 'å·²è¿æ¥';\n            connectButton.disabled = true;\n            drawButton.disabled = false;\n        } else {\n            walletStatus.textContent = 'æœªè¿æ¥é’±åŒ…';\n            walletStatus.className = 'not-connected';\n            connectButton.textContent = 'è¿æ¥é’±åŒ…';\n            connectButton.disabled = false;\n            drawButton.disabled = true;\n        }\n    \n        // æ›´æ–°æŠ½å¥–æˆæœ¬å’Œæ€»æˆæœ¬\n        document.getElementById('cost-amount').textContent = drawCost;\n        updateTotalCost();\n    }\n\n    // ç¼©çŸ­åœ°å€æ˜¾ç¤º\n    function shortenAddress(address) {\n        return `${address.substring(0, 6)}...${address.substring(address.length - 4)}`;\n    }\n}\n\n    /**\n     * ä»¥ä¸‹æ˜¯ä¸æ™ºèƒ½åˆçº¦äº¤äº’çš„å‡½æ•°\n     * æ³¨æ„: è¿™äº›å‡½æ•°éœ€è¦æ ¹æ®å®é™…çš„åˆçº¦ABIè¿›è¡Œè°ƒæ•´\n     * \n     * åˆçº¦å‡½æ•°è¯´æ˜:\n     * 1. draw(): è¿›è¡Œä¸€æ¬¡æŠ½å¥–ï¼Œè¿”å›æŠ½å¥–ç»“æœ\n     * 2. drawCost(): è·å–æ¯æ¬¡æŠ½å¥–çš„æˆæœ¬\n     * 3. drawTimes(): è·å–ç”¨æˆ·çš„æŠ½å¥–æ¬¡æ•°\n     * 4. XWAWA_COIN(): è·å–Xwawaä»£å¸åˆçº¦åœ°å€\n     * \n     * è¿™äº›å‡½æ•°åœ¨å®é™…éƒ¨ç½²æ—¶éœ€è¦æ ¹æ®Lottery.abiæ–‡ä»¶ä¸­çš„å®é™…åˆçº¦æ¥å£è¿›è¡Œè°ƒæ•´\n     */\n\n    // å®é™…è°ƒç”¨åˆçº¦çš„drawå‡½æ•°\n    async function drawFromContract() {\n        try {\n            // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰è¶³å¤Ÿçš„ä»£å¸\n            const xwawaContract = await getXwawaContract();\n            const balance = await xwawaContract.methods.balanceOf(userAccount).call();\n            const requiredAmount = web3.utils.toWei((drawCost * drawTimes).toString(), 'ether');\n        \n            if (parseInt(balance) < parseInt(requiredAmount)) {\n                alert('Xwawaä»£å¸ä½™é¢ä¸è¶³ï¼Œè¯·å……å€¼åå†è¯•');\n                return null;\n            }\n        \n            // æˆæƒåˆçº¦ä½¿ç”¨ä»£å¸\n            await xwawaContract.methods.approve(lotteryContractAddress, requiredAmount).send({ from: userAccount });\n        \n            // è°ƒç”¨æŠ½å¥–å‡½æ•°\n            const result = await lotteryContract.methods.draw().send({ from: userAccount });\n            return result;\n        } catch (error) {\n            console.error(\"åˆçº¦æŠ½å¥–å¤±è´¥:\", error);\n            throw error;\n        }\n    }\n\n    // è·å–Xwawaä»£å¸åˆçº¦\n    async function getXwawaContract() {\n        try {\n            const xwawaAddress = await lotteryContract.methods.XWAWA_COIN().call();\n        \n            // è¿™é‡Œéœ€è¦Xwawaä»£å¸çš„ABIï¼Œè¿™åªæ˜¯ä¸€ä¸ªç¤ºä¾‹\n            const xwawaABI = [\n                {\n                    \"constant\": true,\n                    \"inputs\": [{ \"name\": \"_owner\", \"type\": \"address\" }],\n                    \"name\": \"balanceOf\",\n                    \"outputs\": [{ \"name\": \"balance\", \"type\": \"uint256\" }],\n                    \"type\": \"function\"\n                },\n                {\n                    \"constant\": false,\n                    \"inputs\": [\n                        { \"name\": \"_spender\", \"type\": \"address\" },\n                        { \"name\": \"_value\", \"type\": \"uint256\" }\n                    ],\n                    \"name\": \"approve\",\n                    \"outputs\": [{ \"name\": \"\", \"type\": \"bool\" }],\n                    \"type\": \"function\"\n                }\n            ];\n        \n            return new web3.eth.Contract(xwawaABI, xwawaAddress);\n        } catch (error) {\n            console.error(\"è·å–Xwawaåˆçº¦å¤±è´¥:\", error);\n            throw error;\n        }\n    }\n\n/**\n * æ³¨æ„äº‹é¡¹:\n * 1. æœ¬ä»£ç ä»…ä¸ºå‰ç«¯å®ç°ï¼Œå®é™…ä½¿ç”¨æ—¶éœ€è¦ä¸åç«¯å’ŒåŒºå—é“¾è¿›è¡Œäº¤äº’\n * 2. åˆçº¦è°ƒç”¨éƒ¨åˆ†éœ€è¦æ ¹æ®å®é™…éƒ¨ç½²çš„åˆçº¦è¿›è¡Œè°ƒæ•´\n * 3. æŠ½å¥–ç»“æœåº”è¯¥ç”±åˆçº¦è¿”å›ï¼Œè€Œä¸æ˜¯å‰ç«¯éšæœºç”Ÿæˆ\n * 4. ç”¨æˆ·éœ€è¦æˆæƒåˆçº¦ä½¿ç”¨å…¶Xwawaä»£å¸\n * 5. æŠ½å¥–æˆæœ¬å’Œå¥–é¡¹é…ç½®åº”è¯¥ä»åˆçº¦ä¸­è·å–\n * \n * åç«¯å¼€å‘äººå‘˜éœ€è¦:\n * 1. éƒ¨ç½²Lotteryåˆçº¦\n * 2. ç¡®ä¿åˆçº¦ä¸­æœ‰æ­£ç¡®çš„drawã€drawCostç­‰å‡½æ•°\n * 3. è®¾ç½®æ­£ç¡®çš„Xwawaä»£å¸åœ°å€\n * 4. å®ç°åŒºå—é“¾äº¤æ˜“ç›‘å¬åŠŸèƒ½\n*/\n"],"file":"lottery.dev.js"}