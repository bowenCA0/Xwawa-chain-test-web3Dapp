{"version":3,"sources":["lottery.js"],"names":["web3","lotteryContract","userAccount","isConnected","drawTimes","drawCost","isSpinning","prizes","id","name","probability","color","className","lotteryABI","lotteryContractAddress","xwawaTokenAddress","closeResultModal","modal","document","getElementById","style","display","addEventListener","drawButton","drawTimesMinusBtn","drawTimesPlusBtn","drawTimesInput","startDraw","updateDrawTimes","validateDrawTimes","querySelectorAll","forEach","element","initLanguageSwitch","checkWalletConnection","WalletManager","walletManager","init","languageSwitch","lang","checked","switchLanguage","localStorage","setItem","savedLang","getItem","elements","hasAttribute","textContent","getAttribute","window","ethereum","request","method","accounts","length","Web3","ContractConfig","loadLotteryAbi","abi","addr","lotteryAddress","console","error","eth","Contract","updateDrawCostFromContract","connectWallet","log","on","handleAccountsChanged","handleChainChanged","alert","open","code","methods","call","contractDrawCost","utils","fromWei","costElement","updateTotalCost","chainId","location","reload","change","input","newValue","parseInt","value","isNaN","totalCost","totalCostElement","disabled","drawFromContract","txReceipt","startMagicAnimation","playSpinSound","placeholder","Math","floor","random","spinWheel","setTimeout","addWinEffect","showResultModal","addResultsToList","resetDrawState","getUserTokenBalance","getXwawaContract","xwawaContract","balanceOf","balance","parseFloat","updateUI","walletStatus","connectButton","shortenAddress","address","substring","generateMockResults","results","i","result","getRandomPrize","push","cumulativeProbability","prize","prizeId","wheel","querySelector","wheelContainer","pointer","wheelAura","classList","add","targetAngle","extraRotations","finalRotation","transition","transform","addVibration","createSpinningMagicParticles","createMagicEnergyWave","remove","audioContext","AudioContext","webkitAudioContext","oscillator","createOscillator","gainNode","createGain","connect","destination","frequency","setValueAtTime","currentTime","exponentialRampToValueAtTime","gain","start","stop","e","navigator","vibrate","createFireworks","container","particle","createElement","left","top","appendChild","resultsList","noResults","resultItem","innerHTML","Date","toLocaleTimeString","prepend","resultTitle","resultMessage","resultIcon","getResultMessage","getResultIcon","times","draw","send","from","tx","XWAWA_COIN","xwawaAddress","xwawaABI","magicWizard","magicWand","magicArm","magicParticles","magicSpell","opacity","playMagicSound","createMagicBurst","resetMagicAnimation","frequencies","freq","index","type","linearRampToValueAtTime","colors","background","angle","PI","distance","endX","cos","endY","sin","setProperty","parentNode","removeChild","radius","x","y","wave","borderColor","width","height"],"mappings":"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","sourcesContent":["/**\n * Xwawa 抽奖系统 - 核心JavaScript功能实现\n * \n * 主要功能:\n * 1. Web3钱包连接 (MetaMask等)\n * 2. 智能合约交互 (抽奖合约、代币合约)\n * 3. 抽奖转盘动画和音效\n * 4. 抽奖结果处理和显示\n * 5. 用户界面状态管理\n * \n * 智能合约集成:\n * - 抽奖合约: 处理抽奖逻辑、奖池管理、随机数生成\n * - XWAWA代币合约: 处理代币支付和余额查询\n * - 事件监听: 抽奖结果、代币转账等区块链事件\n * \n * 后端API需求:\n * - POST /api/lottery/draw - 记录抽奖历史\n * - GET /api/lottery/history - 获取用户抽奖记录\n * - GET /api/lottery/stats - 获取抽奖统计数据\n * \n * 安全考虑:\n * - 客户端随机数仅用于动画，实际结果由智能合约生成\n * - 交易签名验证\n * - 防止重复提交\n */\n\n/**\n * 全局变量定义\n * 用于管理Web3连接、合约实例和抽奖状态\n */\nlet web3;                    // Web3实例\nlet lotteryContract;         // 抽奖智能合约实例\nlet userAccount;             // 用户钱包地址\nlet isConnected = false;     // 钱包连接状态\nlet drawTimes = 1;           // 抽奖次数\nlet drawCost = 10000;        // 每次抽奖花费的XWAWA代币数量 (从合约获取)\nlet isSpinning = false;      // 转盘旋转状态锁\n\n/**\n * 奖项配置\n * 定义抽奖奖项的基本信息和概率分布\n * 注意: 实际概率由智能合约控制，此处仅用于前端展示\n */\nconst prizes = [\n    { id: 1, name: \"一等奖\", probability: 0.01, color: \"#FF6B6B\", className: \"first-prize\" },\n    { id: 2, name: \"二等奖\", probability: 0.05, color: \"#4ECDC4\", className: \"second-prize\" },\n    { id: 3, name: \"三等奖\", probability: 0.10, color: \"#FFD166\", className: \"third-prize\" },\n    { id: 4, name: \"奖池分红\", probability: 0.15, color: \"#06D6A0\", className: \"pool-prize\" },\n    { id: 5, name: \"双倍抽奖\", probability: 0.20, color: \"#118AB2\", className: \"double\" },\n    { id: 6, name: \"谢谢参与\", probability: 0.49, color: \"#073B4C\", className: \"nothing\" }\n];\n\n/**\n * 智能合约ABI配置\n * \n * 重要说明:\n * 1. 此ABI需要与部署的智能合约完全匹配\n * 2. 部署合约后，需要从编译输出中获取完整ABI\n * 3. 建议将ABI存储在单独的JSON文件中，通过fetch动态加载\n * \n * 主要合约方法:\n * - draw(): 执行抽奖，返回奖项ID\n * - drawCost(): 获取抽奖费用\n * - getBalance(): 获取用户代币余额\n * - getPrizePool(): 获取奖池金额\n * - getUserDrawHistory(): 获取用户抽奖历史\n * \n * 事件监听:\n * - DrawResult: 抽奖结果事件\n * - PrizeAwarded: 奖品发放事件\n * - PoolUpdated: 奖池更新事件\n */\nconst lotteryABI = [\n    // TODO: 从实际部署的合约中获取完整ABI\n    // 以下是示例结构，实际使用时需要替换\n    {\n        \"inputs\": [\n            { \"internalType\": \"uint256\", \"name\": \"_times\", \"type\": \"uint256\" }\n        ],\n        \"name\": \"draw\",\n        \"outputs\": [\n            { \"internalType\": \"uint8[]\", \"name\": \"winningType\", \"type\": \"uint8[]\" }\n        ],\n        \"stateMutability\": \"nonpayable\",\n        \"type\": \"function\"\n    },\n    {\n        \"inputs\": [],\n        \"name\": \"drawCost\",\n        \"outputs\": [\n            {\n                \"internalType\": \"uint256\",\n                \"name\": \"\",\n                \"type\": \"uint256\"\n            }\n        ],\n        \"stateMutability\": \"view\",\n        \"type\": \"function\"\n    }\n    // 更多方法和事件定义...\n];\n\n/**\n * 智能合约地址配置\n * \n * 部署说明:\n * 1. 在测试网部署合约后，更新此地址\n * 2. 主网部署前，确保合约经过充分测试和审计\n * 3. 建议使用环境变量管理不同网络的合约地址\n * \n * 网络配置:\n * - 测试网: Goerli, Sepolia等\n * - 主网: Ethereum Mainnet\n * - 侧链: Polygon, BSC等\n */\nconst lotteryContractAddress = \"0x1234567890123456789012345678901234567890\"; // TODO: 替换为实际部署地址\n\n/**\n * XWAWA代币合约地址\n * 用于代币余额查询和授权操作\n */\nconst xwawaTokenAddress = \"0x0987654321098765432109876543210987654321\"; // TODO: 替换为实际代币地址\n\n/**\n * 关闭结果弹窗\n */\nfunction closeResultModal() {\n    const modal = document.getElementById('result-modal');\n    if (modal) {\n        modal.style.display = 'none';\n    }\n}\n\n/**\n * 页面初始化\n * 在DOM加载完成后执行所有初始化操作\n */\ndocument.addEventListener('DOMContentLoaded', function() {\n    // 初始化用户界面状态（现在由WalletManager处理）\n    // updateUI();\n    \n    // 绑定用户交互事件\n    // 注意：钱包连接现在由WalletManager处理\n    const drawButton = document.getElementById('draw-button');\n    const drawTimesMinusBtn = document.getElementById('draw-times-minus');\n    const drawTimesPlusBtn = document.getElementById('draw-times-plus');\n    const drawTimesInput = document.getElementById('draw-times-input');\n    \n    if (drawButton) drawButton.addEventListener('click', startDraw);\n    if (drawTimesMinusBtn) drawTimesMinusBtn.addEventListener('click', () => updateDrawTimes(-1));\n    if (drawTimesPlusBtn) drawTimesPlusBtn.addEventListener('click', () => updateDrawTimes(1));\n    if (drawTimesInput) drawTimesInput.addEventListener('change', validateDrawTimes);\n    \n    // 绑定弹窗关闭事件\n    document.querySelectorAll('.close-modal, .close-result-btn').forEach(element => {\n        element.addEventListener('click', closeResultModal);\n    });\n    \n    // 初始化多语言功能\n    initLanguageSwitch();\n    \n    // 检查是否已连接钱包 (页面刷新后恢复状态)\n    checkWalletConnection();\n    \n    // 初始化钱包管理器\n    if (typeof WalletManager !== 'undefined') {\n        const walletManager = new WalletManager();\n        walletManager.init();\n    }\n});\n\n/**\n * 初始化语言切换功能\n * 绑定语言切换开关的事件监听器\n */\nfunction initLanguageSwitch() {\n    const languageSwitch = document.getElementById('language-switch');\n    if (languageSwitch) {\n        languageSwitch.addEventListener('change', function() {\n            const lang = this.checked ? 'en' : 'zh';\n            switchLanguage(lang);\n            // 保存用户语言偏好到本地存储\n            localStorage.setItem('preferred-language', lang);\n        });\n        \n        // 恢复用户语言偏好\n        const savedLang = localStorage.getItem('preferred-language') || 'zh';\n        languageSwitch.checked = savedLang === 'en';\n        switchLanguage(savedLang);\n    }\n}\n\n/**\n * 语言切换功能\n * 根据选择的语言更新页面文本内容\n * @param {string} lang - 语言代码 ('zh' 或 'en')\n */\nfunction switchLanguage(lang) {\n    const elements = document.querySelectorAll('[data-lang-zh], [data-lang-en]');\n    \n    elements.forEach(element => {\n        if (lang === 'zh') {\n            if (element.hasAttribute('data-lang-zh')) {\n                element.textContent = element.getAttribute('data-lang-zh');\n            }\n        } else {\n            if (element.hasAttribute('data-lang-en')) {\n                element.textContent = element.getAttribute('data-lang-en');\n            }\n        }\n    });\n}\n\n/**\n * 检查钱包连接状态\n * 页面加载时检查是否已连接钱包，恢复连接状态\n */\nasync function checkWalletConnection() {\n    if (window.ethereum) {\n        try {\n            const accounts = await window.ethereum.request({ method: 'eth_accounts' });\n            if (accounts.length > 0) {\n                userAccount = accounts[0];\n                web3 = new Web3(window.ethereum);\n                // 动态加载ABI与部署地址\n                try {\n                    const abi = await window.ContractConfig.loadLotteryAbi();\n                    const addr = window.ContractConfig.lotteryAddress;\n                    if (!addr) {\n                        console.error('Lottery合约地址未配置，请在 js/contract-config.js 中填写 lotteryAddress');\n                    } else {\n                        lotteryContract = new web3.eth.Contract(abi, addr);\n                    }\n                } catch (e) {\n                    console.error('加载Lottery ABI失败:', e);\n                }\n                isConnected = true;\n                // updateUI(); // 现在由WalletManager处理\n                \n                // 获取最新的抽奖成本\n                await updateDrawCostFromContract();\n            }\n        } catch (error) {\n            console.error(\"检查钱包连接失败:\", error);\n        }\n    }\n}\n\n/**\n * 连接钱包功能\n * 检测并连接用户的Web3钱包 (主要支持MetaMask)\n * \n * 功能流程:\n * 1. 检测钱包是否安装\n * 2. 请求用户授权连接\n * 3. 初始化Web3实例和智能合约\n * 4. 获取合约参数 (抽奖成本等)\n * 5. 更新UI状态\n * \n * 错误处理:\n * - 钱包未安装: 提示用户安装MetaMask\n * - 用户拒绝连接: 显示连接失败信息\n * - 网络错误: 提示检查网络连接\n * - 合约调用失败: 使用默认参数\n */\nasync function connectWallet() {\n    try {\n        // 检查是否安装了Web3钱包 (MetaMask等)\n        if (window.ethereum) {\n            console.log(\"Web3钱包已检测到\");\n            \n            // 请求用户授权连接钱包\n            const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });\n            userAccount = accounts[0];\n            \n            // 创建Web3实例\n            web3 = new Web3(window.ethereum);\n            \n            // 初始化抽奖智能合约实例\n            // 动态加载ABI与部署地址\n            try {\n                const abi = await window.ContractConfig.loadLotteryAbi();\n                const addr = window.ContractConfig.lotteryAddress;\n                if (!addr) {\n                    console.error('Lottery合约地址未配置，请在 js/contract-config.js 中填写 lotteryAddress');\n                } else {\n                    lotteryContract = new web3.eth.Contract(abi, addr);\n                }\n            } catch (e) {\n                console.error('加载Lottery ABI失败:', e);\n            }\n            \n            // 从智能合约获取最新的抽奖成本\n            await updateDrawCostFromContract();\n            \n            // 监听账户变化事件\n            window.ethereum.on('accountsChanged', handleAccountsChanged);\n            \n            // 监听网络变化事件\n            window.ethereum.on('chainChanged', handleChainChanged);\n            \n            // 更新连接状态\n            isConnected = true;\n            \n            // 更新用户界面\n            // updateUI(); // 现在由WalletManager处理\n            \n            console.log(\"钱包连接成功:\", userAccount);\n            \n        } else {\n            // 钱包未安装的处理\n            alert(\"请安装MetaMask钱包以使用抽奖功能！\");\n            window.open(\"https://metamask.io/download/\", \"_blank\");\n        }\n    } catch (error) {\n        console.error(\"连接钱包失败:\", error);\n        \n        // 根据错误类型显示不同的提示信息\n        if (error.code === 4001) {\n            alert(\"用户拒绝了钱包连接请求\");\n        } else if (error.code === -32002) {\n            alert(\"钱包连接请求已在处理中，请检查MetaMask\");\n        } else {\n            alert(\"连接钱包时发生错误，请重试\");\n        }\n        \n        // 重置连接状态\n        isConnected = false;\n        // updateUI(); // 现在由WalletManager处理\n    }\n}\n\n/**\n * 从智能合约更新抽奖成本\n * 获取合约中设置的最新抽奖费用\n */\nasync function updateDrawCostFromContract() {\n    try {\n        const contractDrawCost = await lotteryContract.methods.drawCost().call();\n        drawCost = web3.utils.fromWei(contractDrawCost, 'ether');\n        console.log(\"合约抽奖成本:\", drawCost);\n        \n        // 更新UI显示\n        const costElement = document.getElementById('cost-amount');\n        if (costElement) {\n            costElement.textContent = drawCost;\n        }\n        \n        // 更新总费用显示\n        updateTotalCost();\n        \n    } catch (error) {\n        console.error(\"获取抽奖成本失败:\", error);\n        // 使用默认值，不影响用户体验\n        const costElement = document.getElementById('cost-amount');\n        if (costElement) {\n            costElement.textContent = drawCost;\n        }\n    }\n}\n\n/**\n * 处理账户变化事件\n * 当用户在MetaMask中切换账户时触发\n */\nfunction handleAccountsChanged(accounts) {\n    if (accounts.length === 0) {\n        // 用户断开了钱包连接\n        isConnected = false;\n        userAccount = null;\n        console.log(\"钱包已断开连接\");\n    } else {\n        // 用户切换了账户\n        userAccount = accounts[0];\n        console.log(\"账户已切换:\", userAccount);\n    }\n    // updateUI(); // 现在由WalletManager处理\n}\n\n/**\n * 处理网络变化事件\n * 当用户在MetaMask中切换网络时触发\n */\nfunction handleChainChanged(chainId) {\n    console.log(\"网络已切换:\", chainId);\n    // 重新加载页面以确保应用状态正确\n    window.location.reload();\n}\n\n/**\n * 更新抽奖次数\n * 通过加减按钮调整抽奖次数\n * @param {number} change - 变化量 (+1 或 -1)\n */\nfunction updateDrawTimes(change) {\n    const input = document.getElementById('draw-times-input');\n    let newValue = parseInt(input.value) + change;\n    \n    // 确保次数在有效范围内 (1-100次)\n    if (newValue < 1) newValue = 1;\n    if (newValue > 100) newValue = 100;\n    \n    input.value = newValue;\n    drawTimes = newValue;\n    updateTotalCost();\n}\n\n/**\n * 验证抽奖次数输入\n * 当用户直接在输入框中输入数字时进行验证\n */\nfunction validateDrawTimes() {\n    const input = document.getElementById('draw-times-input');\n    let value = parseInt(input.value);\n    \n    // 确保输入是有效数字且在允许范围内\n    if (isNaN(value) || value < 1) {\n        value = 1;\n    } else if (value > 100) {\n        value = 100;\n    }\n    \n    input.value = value;\n    drawTimes = value;\n    updateTotalCost();\n}\n\n/**\n * 更新总花费显示\n * 根据抽奖次数和单次费用计算总费用\n */\nfunction updateTotalCost() {\n    const totalCost = drawTimes * drawCost;\n    const totalCostElement = document.getElementById('total-cost-amount');\n    if (totalCostElement) {\n        totalCostElement.textContent = totalCost;\n    }\n}\n\n/**\n * 开始抽奖功能\n * 执行抽奖流程，包括智能合约交互和结果处理\n * \n * 抽奖流程:\n * 1. 验证钱包连接状态\n * 2. 检查用户代币余额\n * 3. 调用智能合约执行抽奖\n * 4. 处理抽奖结果和动画\n * 5. 更新用户界面和历史记录\n * \n * 智能合约交互:\n * - 检查用户XWAWA代币余额\n * - 授权合约扣除代币\n * - 调用抽奖合约方法\n * - 监听抽奖结果事件\n * \n * 后端API调用:\n * - POST /api/lottery/draw - 记录抽奖历史\n * - PUT /api/users/balance - 更新用户余额\n */\nasync function startDraw() {\n    // 检查钱包连接状态\n    if (!isConnected) {\n        alert('请先连接钱包');\n        return;\n    }\n    \n    // 防止重复抽奖\n    if (isSpinning) {\n        return;\n    }\n    \n    // 设置抽奖状态，禁用抽奖按钮\n    isSpinning = true;\n    const drawButton = document.getElementById('draw-button');\n    if (drawButton) {\n        drawButton.disabled = true;\n        drawButton.textContent = '抽奖中...';\n    }\n    \n    try {\n        const txReceipt = await drawFromContract(drawTimes);\n        startMagicAnimation();\n        playSpinSound();\n        const placeholder = prizes[Math.floor(Math.random() * prizes.length)];\n        spinWheel(placeholder.id);\n        setTimeout(() => {\n            if (placeholder.id <= 4) {\n                addWinEffect(placeholder.id);\n            }\n            showResultModal(placeholder);\n            addResultsToList([placeholder]);\n            resetDrawState();\n        }, 5200);\n    } catch (error) {\n        console.error('抽奖失败:', error);\n        alert('抽奖失败，请重试');\n        resetDrawState();\n    }\n}\n\n/**\n * 重置抽奖状态\n * 恢复抽奖按钮和相关UI状态\n */\nfunction resetDrawState() {\n    isSpinning = false;\n    const drawButton = document.getElementById('draw-button');\n    if (drawButton) {\n        drawButton.disabled = false;\n        drawButton.textContent = '开始抽奖';\n    }\n}\n\n/**\n * 获取用户代币余额\n * 从XWAWA代币合约查询用户余额\n * @returns {Promise<number>} 用户代币余额\n */\nasync function getUserTokenBalance() {\n    try {\n        const xwawaContract = await getXwawaContract();\n        const balance = await xwawaContract.methods.balanceOf(userAccount).call();\n        return parseFloat(web3.utils.fromWei(balance, 'ether'));\n    } catch (error) {\n        console.error(\"获取用户余额失败:\", error);\n        return 0;\n    }\n}\n\n/**\n * 更新UI状态\n */\nfunction updateUI() {\n    const walletStatus = document.getElementById('wallet-status');\n    const connectButton = document.getElementById('connect-wallet-btn');\n    const drawButton = document.getElementById('draw-button');\n\n    if (isConnected) {\n        walletStatus.textContent = `已连接: ${shortenAddress(userAccount)}`;\n        walletStatus.className = 'connected';\n        connectButton.textContent = '已连接';\n        connectButton.disabled = true;\n        drawButton.disabled = false;\n    } else {\n        walletStatus.textContent = '未连接钱包';\n        walletStatus.className = 'not-connected';\n        connectButton.textContent = '连接钱包';\n        connectButton.disabled = false;\n        drawButton.disabled = true;\n    }\n\n    // 更新抽奖成本和总成本\n    document.getElementById('cost-amount').textContent = drawCost;\n    updateTotalCost();\n}\n\n/**\n * 缩短地址显示\n * @param {string} address - 钱包地址\n * @returns {string} 缩短后的地址\n */\nfunction shortenAddress(address) {\n    return `${address.substring(0, 6)}...${address.substring(address.length - 4)}`;\n}\n\n/**\n * 模拟抽奖结果生成 (仅用于开发测试)\n * 实际生产环境中，结果应完全由智能合约生成\n * @returns {Array} 抽奖结果数组\n */\nfunction generateMockResults() {\n    const results = [];\n    for (let i = 0; i < drawTimes; i++) {\n        // 随机选择一个奖项 (仅用于前端展示)\n        const result = getRandomPrize();\n        results.push(result);\n            \n        // 如果是第一次抽奖，旋转转盘\n        if (i === 0) {\n            spinWheel(result.id);\n        }\n    }\n        \n    // 添加抽奖结果到结果列表\n    addResultsToList(results);\n        \n    // 如果只抽奖一次，显示结果弹窗\n    if (drawTimes === 1) {\n        setTimeout(() => {\n            showResultModal(results[0]);\n        }, 5500); // 等待转盘停止后显示\n    }\n        \n    console.log(\"抽奖完成，结果:\", results);\n    try {\n        console.error(\"抽奖失败:\", error);\n        alert('抽奖失败，请重试');\n        isSpinning = false;\n        document.getElementById('draw-button').disabled = false;\n    }\n    catch (error) {\n        console.error(\"抽奖失败:\", error);\n        alert('抽奖失败，请重试');\n        isSpinning = false;\n        document.getElementById('draw-button').disabled = false;\n    }\n\n    // 获取随机奖项\n    function getRandomPrize() {\n        const random = Math.random();\n        let cumulativeProbability = 0;\n    \n        for (const prize of prizes) {\n            cumulativeProbability += prize.probability;\n            if (random <= cumulativeProbability) {\n                return prize;\n            }\n        }\n    \n        // 默认返回最后一个奖项\n        return prizes[prizes.length - 1];\n    }\n\n    // 魔法转盘旋转 - 魔法主题优化版本\n    function spinWheel(prizeId) {\n        const wheel = document.querySelector('.wheel-inner');\n        const wheelContainer = document.querySelector('.lottery-wheel-container');\n        const pointer = document.querySelector('.wheel-pointer');\n        const wheelAura = document.querySelector('.wheel-magic-aura');\n    \n        // 添加魔法旋转开始的视觉效果\n        wheelContainer.classList.add('spinning', 'magic-spinning');\n        pointer.classList.add('pointer-active');\n        \n        // 激活魔法光环\n        if (wheelAura) {\n            wheelAura.classList.add('spinning-aura');\n        }\n    \n        // 计算旋转角度\n        // 每个奖项占60度，计算目标奖项的中心角度\n        const targetAngle = (prizeId - 1) * 60 + 30;\n    \n        // 添加随机的额外旋转圈数 (8-12圈，更多圈数增加魔法感)\n        const extraRotations = (8 + Math.random() * 4) * 360;\n    \n        // 最终旋转角度 = 额外圈数 + (360 - 目标角度)\n        const finalRotation = extraRotations + (360 - targetAngle);\n    \n        // 应用魔法旋转动画 - 更长的动画时间和魔法曲线\n        wheel.style.transition = 'transform 5s cubic-bezier(0.23, 1, 0.32, 1)';\n        wheel.style.transform = `rotate(${finalRotation}deg)`;\n    \n        // 添加音效和震动效果 (如果支持)\n        playSpinSound();\n        addVibration();\n        \n        // 创建魔法旋转粒子效果\n        createSpinningMagicParticles();\n    \n        // 动画过程中的魔法效果\n        setTimeout(() => {\n            // 中途添加魔法能量爆发\n            wheelContainer.classList.add('mid-spin', 'magic-burst');\n            createMagicEnergyWave();\n        }, 2500);\n    \n        // 动画结束后的处理\n        setTimeout(() => {\n            isSpinning = false;\n            wheelContainer.classList.remove('spinning', 'mid-spin', 'magic-spinning', 'magic-burst');\n            pointer.classList.remove('pointer-active');\n            wheelContainer.classList.add('spin-complete');\n            \n            if (wheelAura) {\n                wheelAura.classList.remove('spinning-aura');\n            }\n        \n            // 添加获奖效果\n            addWinEffect(prizeId);\n        \n            document.getElementById('draw-button').disabled = false;\n        \n            // 清除完成状态\n            setTimeout(() => {\n                wheelContainer.classList.remove('spin-complete');\n            }, 1000);\n        }, 5000); // 延长到5秒匹配新的动画时间\n    }\n\n    // 播放旋转音效\n    function playSpinSound() {\n        try {\n            // 创建音频上下文来播放简单的音效\n            const audioContext = new (window.AudioContext || window.webkitAudioContext)();\n            const oscillator = audioContext.createOscillator();\n            const gainNode = audioContext.createGain();\n        \n            oscillator.connect(gainNode);\n            gainNode.connect(audioContext.destination);\n        \n            oscillator.frequency.setValueAtTime(200, audioContext.currentTime);\n            oscillator.frequency.exponentialRampToValueAtTime(100, audioContext.currentTime + 0.1);\n        \n            gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);\n            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);\n        \n            oscillator.start(audioContext.currentTime);\n            oscillator.stop(audioContext.currentTime + 0.1);\n        } catch (e) {\n            // 如果音频API不支持，静默失败\n            console.log('Audio not supported');\n        }\n    }\n\n    // 添加震动效果\n    function addVibration() {\n        if ('vibrate' in navigator) {\n            navigator.vibrate([100, 50, 100]);\n        }\n    }\n\n    // 添加获奖效果\n    function addWinEffect(prizeId) {\n        const wheelContainer = document.querySelector('.lottery-wheel-container');\n    \n        // 根据奖项等级添加不同的效果\n        if (prizeId <= 3) {\n            // 高级奖项：添加闪光效果\n            wheelContainer.classList.add('major-win');\n            createFireworks();\n            setTimeout(() => {\n                wheelContainer.classList.remove('major-win');\n            }, 3000);\n        } else if (prizeId <= 5) {\n            // 中级奖项：添加发光效果\n            wheelContainer.classList.add('minor-win');\n            setTimeout(() => {\n                wheelContainer.classList.remove('minor-win');\n            }, 2000);\n        }\n    }\n\n    // 创建烟花效果\n    function createFireworks() {\n        const container = document.querySelector('.lottery-wheel-container');\n    \n        for (let i = 0; i < 20; i++) {\n            setTimeout(() => {\n                const particle = document.createElement('div');\n                particle.className = 'firework-particle';\n                particle.style.left = Math.random() * 100 + '%';\n                particle.style.top = Math.random() * 100 + '%';\n                container.appendChild(particle);\n            \n                setTimeout(() => {\n                    particle.remove();\n                }, 1000);\n            }, i * 100);\n        }\n    }\n\n    // 添加结果到列表\n    function addResultsToList(results) {\n        const resultsList = document.querySelector('.results-list');\n        const noResults = document.querySelector('.no-results');\n    \n        if (noResults) {\n            noResults.style.display = 'none';\n        }\n    \n        results.forEach(result => {\n            const resultItem = document.createElement('div');\n            resultItem.className = `result-item ${result.className}`;\n        \n            resultItem.innerHTML = `\n            <span class=\"result-name\">${result.name}</span>\n            <span class=\"result-value\">${new Date().toLocaleTimeString()}</span>\n        `;\n        \n            resultsList.prepend(resultItem);\n        });\n    }\n\n    // 显示结果弹窗\n    function showResultModal(result) {\n        const modal = document.getElementById('result-modal');\n        const resultTitle = document.getElementById('result-title');\n        const resultMessage = document.getElementById('result-message');\n        const resultIcon = document.getElementById('result-icon');\n    \n        // 设置结果信息\n        resultTitle.textContent = `恭喜获得: ${result.name}`;\n        resultMessage.textContent = getResultMessage(result.id);\n        resultIcon.textContent = getResultIcon(result.id);\n        resultIcon.style.color = result.color;\n    \n        // 显示弹窗\n        modal.style.display = 'block';\n    }\n\n    // 关闭结果弹窗 - 移除，将在文件顶部重新定义\n\n    // 获取结果消息\n    function getResultMessage(prizeId) {\n        switch (prizeId) {\n            case 1:\n                return \"恭喜您获得一等奖！奖励已发放到您的账户。\";\n            case 2:\n                return \"恭喜您获得二等奖！奖励已发放到您的账户。\";\n            case 3:\n                return \"恭喜您获得三等奖！奖励已发放到您的账户。\";\n            case 4:\n                return \"您获得了奖池分红！奖励已发放到您的账户。\";\n            case 5:\n                return \"您获得了双倍抽奖机会！下次抽奖将获得双倍奖励。\";\n            case 6:\n                return \"谢谢参与，下次再接再厉！\";\n            default:\n                return \"抽奖结果未知，请联系客服。\";\n        }\n    }\n\n    // 获取结果图标\n    function getResultIcon(prizeId) {\n        switch (prizeId) {\n            case 1:\n                return \"🏆\";\n            case 2:\n                return \"🥈\";\n            case 3:\n                return \"🥉\";\n            case 4:\n                return \"💰\";\n            case 5:\n                return \"🎯\";\n            case 6:\n                return \"😊\";\n            default:\n                return \"❓\";\n        }\n    }\n\n\n}\n\n    /**\n     * 以下是与智能合约交互的函数\n     * 注意: 这些函数需要根据实际的合约ABI进行调整\n     * \n     * 合约函数说明:\n     * 1. draw(): 进行一次抽奖，返回抽奖结果\n     * 2. drawCost(): 获取每次抽奖的成本\n     * 3. drawTimes(): 获取用户的抽奖次数\n     * 4. XWAWA_COIN(): 获取Xwawa代币合约地址\n     * \n     * 这些函数在实际部署时需要根据Lottery.abi文件中的实际合约接口进行调整\n     */\n\n    // 实际调用合约的draw函数\n    async function drawFromContract(times) {\n        try {\n            const tx = await lotteryContract.methods.draw(times).send({ from: userAccount });\n            return tx;\n        } catch (error) {\n            console.error(\"合约抽奖失败:\", error);\n            throw error;\n        }\n    }\n\n    // 获取Xwawa代币合约\n    async function getXwawaContract() {\n        try {\n            const xwawaAddress = await lotteryContract.methods.XWAWA_COIN().call();\n        \n            // 这里需要Xwawa代币的ABI，这只是一个示例\n            const xwawaABI = [\n                {\n                    \"constant\": true,\n                    \"inputs\": [{ \"name\": \"_owner\", \"type\": \"address\" }],\n                    \"name\": \"balanceOf\",\n                    \"outputs\": [{ \"name\": \"balance\", \"type\": \"uint256\" }],\n                    \"type\": \"function\"\n                },\n                {\n                    \"constant\": false,\n                    \"inputs\": [\n                        { \"name\": \"_spender\", \"type\": \"address\" },\n                        { \"name\": \"_value\", \"type\": \"uint256\" }\n                    ],\n                    \"name\": \"approve\",\n                    \"outputs\": [{ \"name\": \"\", \"type\": \"bool\" }],\n                    \"type\": \"function\"\n                }\n            ];\n        \n            return new web3.eth.Contract(xwawaABI, xwawaAddress);\n        } catch (error) {\n            console.error(\"获取Xwawa合约失败:\", error);\n            throw error;\n        }\n    }\n\n/**\n * 魔法师Xwawa动画系统\n * 实现魔法棒挥动、魔法粒子效果和转盘魔法化\n */\n\n// 启动魔法动画序列\nfunction startMagicAnimation() {\n    const magicWizard = document.querySelector('.magic-wizard');\n    const magicWand = document.querySelector('.magic-wand');\n    const magicArm = document.querySelector('#magic-arm');\n    const magicParticles = document.querySelector('.magic-particles');\n    const magicSpell = document.querySelector('.magic-spell');\n    const wheelAura = document.querySelector('.wheel-magic-aura');\n    \n    if (!magicWizard) return;\n    \n    // 1. 魔法师准备施法\n    magicWizard.classList.add('casting');\n    \n    // 2. 显示魔法咒语\n    if (magicSpell) {\n        magicSpell.style.opacity = '1';\n        magicSpell.style.transform = 'translateY(-10px)';\n    }\n    \n    // 3. 手臂和魔法棒开始挥动\n    setTimeout(() => {\n        // 手臂挥动动画\n        if (magicArm) {\n            magicArm.classList.add('casting');\n        }\n        \n        // 魔法棒挥动动画\n        if (magicWand) {\n            magicWand.classList.add('waving');\n        }\n        \n        // 激活魔法粒子效果\n        if (magicParticles) {\n            magicParticles.classList.add('active');\n        }\n        \n        // 播放魔法音效\n        playMagicSound();\n        \n    }, 500);\n    \n    // 4. 转盘获得魔法光环\n    setTimeout(() => {\n        if (wheelAura) {\n            wheelAura.classList.add('active');\n        }\n        \n        // 创建魔法粒子爆发效果\n        createMagicBurst();\n        \n    }, 1000);\n    \n    // 5. 动画结束后重置状态\n    setTimeout(() => {\n        resetMagicAnimation();\n    }, 6000);\n}\n\n// 重置魔法动画状态\nfunction resetMagicAnimation() {\n    const magicWizard = document.querySelector('.magic-wizard');\n    const magicWand = document.querySelector('.magic-wand');\n    const magicArm = document.querySelector('#magic-arm');\n    const magicParticles = document.querySelector('.magic-particles');\n    const magicSpell = document.querySelector('.magic-spell');\n    const wheelAura = document.querySelector('.wheel-magic-aura');\n    \n    if (magicWizard) magicWizard.classList.remove('casting');\n    if (magicWand) magicWand.classList.remove('waving');\n    if (magicArm) magicArm.classList.remove('casting');\n    if (magicParticles) magicParticles.classList.remove('active');\n    if (wheelAura) wheelAura.classList.remove('active');\n    \n    if (magicSpell) {\n        magicSpell.style.opacity = '0';\n        magicSpell.style.transform = 'translateY(0)';\n    }\n}\n\n// 播放魔法音效\nfunction playMagicSound() {\n    try {\n        const audioContext = new (window.AudioContext || window.webkitAudioContext)();\n        \n        // 创建魔法音效序列\n        const frequencies = [440, 554, 659, 880]; // A4, C#5, E5, A5 - 魔法和弦\n        \n        frequencies.forEach((freq, index) => {\n            setTimeout(() => {\n                const oscillator = audioContext.createOscillator();\n                const gainNode = audioContext.createGain();\n                \n                oscillator.connect(gainNode);\n                gainNode.connect(audioContext.destination);\n                \n                oscillator.frequency.setValueAtTime(freq, audioContext.currentTime);\n                oscillator.type = 'sine';\n                \n                gainNode.gain.setValueAtTime(0, audioContext.currentTime);\n                gainNode.gain.linearRampToValueAtTime(0.1, audioContext.currentTime + 0.1);\n                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);\n                \n                oscillator.start(audioContext.currentTime);\n                oscillator.stop(audioContext.currentTime + 0.5);\n            }, index * 150);\n        });\n        \n    } catch (e) {\n        console.log('Magic audio not supported');\n    }\n}\n\n// 创建魔法粒子爆发效果\nfunction createMagicBurst() {\n    const wheelContainer = document.querySelector('.lottery-wheel-container');\n    if (!wheelContainer) return;\n    \n    // 创建多个魔法粒子\n    for (let i = 0; i < 30; i++) {\n        setTimeout(() => {\n            const particle = document.createElement('div');\n            particle.className = 'magic-burst-particle';\n            \n            // 随机位置和颜色\n            const colors = ['#FFD700', '#FF69B4', '#00FFFF', '#FF6347', '#98FB98'];\n            particle.style.background = colors[Math.floor(Math.random() * colors.length)];\n            particle.style.left = (50 + (Math.random() - 0.5) * 60) + '%';\n            particle.style.top = (50 + (Math.random() - 0.5) * 60) + '%';\n            \n            // 随机运动方向\n            const angle = Math.random() * Math.PI * 2;\n            const distance = 100 + Math.random() * 100;\n            const endX = Math.cos(angle) * distance;\n            const endY = Math.sin(angle) * distance;\n            \n            particle.style.setProperty('--end-x', endX + 'px');\n            particle.style.setProperty('--end-y', endY + 'px');\n            \n            wheelContainer.appendChild(particle);\n            \n            // 粒子动画\n            setTimeout(() => {\n                particle.style.transform = `translate(var(--end-x), var(--end-y)) scale(0)`;\n                particle.style.opacity = '0';\n            }, 50);\n            \n            // 清理粒子\n            setTimeout(() => {\n                if (particle.parentNode) {\n                    particle.parentNode.removeChild(particle);\n                }\n            }, 2000);\n            \n        }, i * 50);\n    }\n}\n\n// 创建魔法旋转粒子效果\nfunction createSpinningMagicParticles() {\n    const wheelContainer = document.querySelector('.lottery-wheel-container');\n    if (!wheelContainer) return;\n    \n    // 创建围绕转盘旋转的魔法粒子\n    for (let i = 0; i < 20; i++) {\n        setTimeout(() => {\n            const particle = document.createElement('div');\n            particle.className = 'spinning-magic-particle';\n            \n            // 魔法颜色\n            const colors = ['#FFD700', '#FF69B4', '#00FFFF', '#9370DB', '#FF6347'];\n            particle.style.background = colors[Math.floor(Math.random() * colors.length)];\n            \n            // 设置初始位置（圆形轨道）\n            const angle = (i / 20) * Math.PI * 2;\n            const radius = 150;\n            const x = 50 + Math.cos(angle) * radius / 4; // 转换为百分比\n            const y = 50 + Math.sin(angle) * radius / 4;\n            \n            particle.style.left = x + '%';\n            particle.style.top = y + '%';\n            particle.style.setProperty('--orbit-angle', angle + 'rad');\n            \n            wheelContainer.appendChild(particle);\n            \n            // 清理粒子\n            setTimeout(() => {\n                if (particle.parentNode) {\n                    particle.parentNode.removeChild(particle);\n                }\n            }, 5000);\n            \n        }, i * 100);\n    }\n}\n\n// 创建魔法能量波效果\nfunction createMagicEnergyWave() {\n    const wheelContainer = document.querySelector('.lottery-wheel-container');\n    if (!wheelContainer) return;\n    \n    // 创建能量波\n    for (let i = 0; i < 3; i++) {\n        setTimeout(() => {\n            const wave = document.createElement('div');\n            wave.className = 'magic-energy-wave';\n            \n            // 设置波的颜色\n            const colors = ['#FFD700', '#FF69B4', '#00FFFF'];\n            wave.style.borderColor = colors[i];\n            wave.style.left = '50%';\n            wave.style.top = '50%';\n            wave.style.transform = 'translate(-50%, -50%)';\n            \n            wheelContainer.appendChild(wave);\n            \n            // 波动画\n            setTimeout(() => {\n                wave.style.width = '400px';\n                wave.style.height = '400px';\n                wave.style.opacity = '0';\n            }, 50);\n            \n            // 清理波\n            setTimeout(() => {\n                if (wave.parentNode) {\n                    wave.parentNode.removeChild(wave);\n                }\n            }, 1500);\n            \n        }, i * 300);\n    }\n}\n\n/**\n * 注意事项:\n * 1. 本代码仅为前端实现，实际使用时需要与后端和区块链进行交互\n * 2. 合约调用部分需要根据实际部署的合约进行调整\n * 3. 抽奖结果应该由合约返回，而不是前端随机生成\n * 4. 用户需要授权合约使用其Xwawa代币\n * 5. 抽奖成本和奖项配置应该从合约中获取\n * \n * 后端开发人员需要:\n * 1. 部署Lottery合约\n * 2. 确保合约中有正确的draw、drawCost等函数\n * 3. 设置正确的Xwawa代币地址\n * 4. 实现区块链交易监听功能\n*/\n"],"file":"lottery.dev.js"}